(this.webpackJsonpsearch=this.webpackJsonpsearch||[]).push([[0],{286:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(62),o=t.n(r),c=t(199),l=t(28),s=new l.QueryClient({defaultOptions:{queries:{useErrorBoundary:!0,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:!1}}}),d=t(305),u=t(378),v=t(358),j=t(216),b=t(1),h=Object(j.a)({palette:{background:{default:"#f9f9f9"},primary:{light:"#f5a733",main:"#f39200",dark:"#aa6600"},secondary:{light:"#72cdee",main:"#4fc1ea",dark:"#3787a3"},text:{primary:"#363636",secondary:"#999"}},typography:{fontFamily:"open sans, sans-serif",h4:{fontWeight:700,fontSize:"3rem",color:"#363636",lineHeight:1.125},h5:{fontWeight:600,fontSize:"2rem",lineHeight:1.125,color:"#363636"},h6:{fontWeight:600,fontSize:"1.2rem",color:"#444f60",lineHeight:1.5},body1:{fontWeight:400,fontSize:"1.25rem",lineHeight:1.25,color:"#000"},body2:{fontWeight:400,fontSize:"1rem",lineHeight:1.5,color:"#000"},subtitle1:{fontWeight:400,fontSize:"1.25rem",lineHeight:1.25,color:"#999"},subtitle2:{fontWeight:400,fontSize:"1rem",lineHeight:1.5,color:"#999"}}});var p=function(e){var n=e.children;return Object(b.jsxs)(u.a,{theme:h,children:[Object(b.jsx)(v.a,{}),n]})},m=t(5),O=a.createContext(void 0);function x(e,n){return n.type,e}var f=a.createContext(void 0),g={};function y(e){var n=e.children,t=a.useReducer(x,g),i=Object(m.a)(t,2),r=i[0],o=i[1];return Object(b.jsx)(O.Provider,{value:r,children:Object(b.jsx)(f.Provider,{value:o,children:n})})}var k=t(306),_=function(){return Object(b.jsx)(k.a,{pb:3,pt:6,sx:{backgroundColor:"#444f60",textAlign:"center",color:"white"},children:"This is a footer"})},w=t(360),S=function(e){var n=e.children;return Object(b.jsxs)(w.a,{direction:"column",justifyContent:"flex-start",children:[Object(b.jsx)("div",{style:{minHeight:"100vh",padding:"1.5rem 4rem 9rem 4rem"},children:n}),Object(b.jsx)(_,{})]})},C=t(370),E=t(379),A=t(24),P=t(46),L=function(e){var n=e.children,t=e.header,i=Object(A.f)(),r=Object(a.useMemo)((function(){var e=i.pathname.split("/").at(-1);return"summary"===e||"details"===e?e:"summary"}),[i.pathname]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{children:[t,Object(b.jsxs)(C.a,{value:r,indicatorColor:"primary",textColor:"primary",children:[Object(b.jsx)(E.a,{label:"Summary",value:"summary",component:P.b,to:"summary"}),Object(b.jsx)(E.a,{label:"Advise Results",value:"details",component:P.b,to:"details"})]})]}),Object(b.jsx)("div",{children:n})]})},M=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Oops, something went wrong :( "}),Object(b.jsx)(d.a,{onClick:function(){return window.location.assign(window.location.origin)},children:"Refresh"})]})},I=function(e){var n=e.children;return Object(b.jsx)(p,{children:Object(b.jsx)(y,{children:Object(b.jsx)(c.ErrorBoundary,{FallbackComponent:M,children:Object(b.jsx)(l.QueryClientProvider,{client:s,children:Object(b.jsx)(S,{children:n})})})})})},N=t(374),V=t(147),D=t(376),R=t(389),T=t(367),B=t(37),q=t(366),F=t(11),z=t(52),W=["children","value","index"],H=function(e){var n=e.children,t=e.value,a=e.index,i=Object(z.a)(e,W);return Object(b.jsx)("div",Object(F.a)(Object(F.a)({role:"tabpanel",hidden:t!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),{},{children:t===a&&n}))},G=t.p+"static/media/thoth-logo.1a28a729.png",K=t(32),U=t(18),Q=t.n(U),J=t(226),Y=t(36),Z=["onEnter","label","helpertext","boxprops","error","lefticon","righticon"],X=function(e){var n=e.onEnter,t=e.label,a=e.helpertext,i=e.boxprops,r=e.error,o=void 0!==r&&r,c=e.lefticon,l=e.righticon,s=Object(z.a)(e,Z);return Object(b.jsxs)(k.a,{children:[Object(b.jsx)(V.a,{variant:"body1",sx:{color:o?"error.main":"text.secondary"},children:t}),Object(b.jsxs)(J.a,{component:"form",variant:"outlined",sx:Object(F.a)({p:"8px 4px",display:"flex",alignItems:"center",borderColor:o?"red":void 0,paddingLeft:2,paddingRight:2},i),children:[c,Object(b.jsx)(Y.c,Object(F.a)({sx:{ml:1,flex:1},placeholder:a,error:o,onChange:s.onChange,onKeyPress:function(e){n&&"Enter"===e.key&&(n(),e.preventDefault())}},s)),l]})]})},$=t(87),ee=t.n($),ne=t(30),te=t.n(ne),ae="https://khemenu.thoth-station.ninja/api/v1",ie={manipulation:{enabled:!1},interaction:{hover:!0,hoverConnectedEdges:!1,selectConnectedEdges:!1,selectable:!0},edges:{chosen:!1,smooth:!1,color:{color:"#5c6470"},arrowStrikethrough:!1,arrows:{from:{enabled:!0,type:"triangle"}}},nodes:{chosen:!1,color:{background:"#5c6470",border:"#fff",hover:{background:"#f39200",border:"#fff"}},shape:"dot",size:10,borderWidth:2,labelHighlightBold:!1,font:{color:"#393e46",strokeWidth:2,size:15}},physics:{hierarchicalRepulsion:{damping:.1,springLength:200},solver:"hierarchicalRepulsion",minVelocity:.15}},re=function(e,n,t){var a={application_stack:{requirements:e,requirements_format:"pipenv",requirements_lock:n},runtime_environment:t};return te.a.post(ae+"/advise/python",a,{params:{recommendation_type:"stable",limit:500},headers:{accept:"application/json","Content-Type":"application/json"}})},oe=function(){var e=Object(K.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.get(ae+"/python/package/versions",{params:{name:n,per_page:1},headers:{accept:"application/json"}}).then((function(e){return e.data.versions.length>0})).catch((function(){return!1})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ce=function(e){return te.a.post(ae+"/analyze",{},{params:{image:e},headers:{accept:"application/json","Content-Type":"application/json"}})},le=function(){var e=Object(K.a)(Q.a.mark((function e(){var n,t,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:100,e.abrupt("return",te.a.get(ae+"/container-images",{params:{page:n,per_page:t},headers:{accept:"application/json"}}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(A.g)(),n=Object(a.useState)(""),t=Object(m.a)(n,2),i=t[0],r=t[1],o=Object(a.useState)(""),c=Object(m.a)(o,2),l=c[0],s=c[1],u=function(){var n=Object(K.a)(Q.a.mark((function n(){return Q.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==i){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,oe(i);case 4:n.sent?e("/package/"+i):s("Thoth does not know about that package");case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(b.jsxs)(N.a,{container:!0,justifyContent:"center",children:[Object(b.jsx)(N.a,{alignSelf:"flex-start",item:!0,xs:12,children:Object(b.jsx)(V.a,{color:"error",variant:"body1",sx:{minHeight:30},children:null!==l&&void 0!==l?l:""})}),Object(b.jsxs)(N.a,{container:!0,spacing:2,item:!0,xs:12,children:[Object(b.jsx)(N.a,{item:!0,xs:12,md:10,children:Object(b.jsx)(X,{error:""!==l,onChange:function(e){return function(e){r(e.target.value),""!==l&&s("")}(e)},helpertext:"Search for a Python package",type:"search",boxprops:{mr:2},lefticon:Object(b.jsx)(ee.a,{}),onEnter:u})}),Object(b.jsx)(N.a,{item:!0,xs:12,md:2,children:Object(b.jsx)(d.a,{variant:"contained",color:"primary",onClick:function(){return u()},sx:{minHeight:"100%",minWidth:"100%"},children:Object(b.jsx)("b",{children:"Analyze"})})})]})]})},de=t(3),ue=t(382),ve=t(168),je=t(396),be=t(296),he=t(224),pe=Object(be.a)();function me(e){var n=e.suggestions,t=e.label,i=e.help,r=e.required,o=e.error,c=e.value,l=e.setValue,s=Object(a.useMemo)((function(){return n.map((function(e){return{title:e}}))}),[n]);return Object(b.jsx)(he.a,{value:c,onChange:function(e,n){"string"===typeof n?l({title:n}):n&&n.inputValue?l({title:n.inputValue}):l(n)},filterOptions:function(e,n){var t=pe(e,n);return""!==n.inputValue&&t.push({inputValue:n.inputValue,title:'Add "'.concat(n.inputValue,'"')}),t},selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-demo",options:null!==s&&void 0!==s?s:[],getOptionLabel:function(e){return"string"===typeof e?e:e.inputValue?e.inputValue:e.title},renderOption:function(e,n){return Object(b.jsx)("li",Object(F.a)(Object(F.a)({},e),{},{children:n.title}))},freeSolo:!0,renderInput:function(e){return Object(b.jsx)(ve.a,Object(F.a)(Object(F.a)({},e),{},{fullWidth:!0,label:t,required:r,error:o,helperText:i}))}})}function Oe(e,n){var t;switch(n.type){case"loading":return Object(F.a)(Object(F.a)({},e),{},{loading:n.payload});case"error":return Object(F.a)(Object(F.a)({},e),{},{error:Object(F.a)(Object(F.a)({},e.error),{},Object(de.a)({},n.param,n.payload))});case"clear-error":return e.error={},e;case"input":return Object(F.a)(Object(F.a)({},e),{},(t={},Object(de.a)(t,n.param,n.payload),Object(de.a)(t,"error",Object(F.a)(Object(F.a)({},e.error),{},Object(de.a)({},n.param,void 0))),t));default:throw new Error("Advise state dispatch error")}}var xe={error:{},loading:!1,lookupType:"id",operating_system_name:"ubi",operating_system_version:"8",python_version:"3.8",cuda_version:"",cudnn_version:"",mkl_version:"",name:"",openblas_version:"",openmpi_version:"",base_image:""},fe=function(){var e,n,t,i,r,o,c,l,s,u,v,j,h,p,O,x,f,g,y=Object(A.g)(),k=Object(a.useReducer)(Oe,xe),_=Object(m.a)(k,2),w=_[0],S=_[1],C=function(){if("id"!==w.lookupType){var e=!0;return w.pipfile||(e=!1,S({type:"error",param:"pipfile",payload:"Field cant be empty"})),w.pipfileLock||(e=!1,S({type:"error",param:"pipfileLock",payload:"Field cant be empty"})),w.name||(e=!1,S({type:"error",param:"name",payload:"Field cant be empty"})),e}return!(!w.id||""===w.id)||(S({type:"error",param:"id",payload:"Field cant be empty"}),!1)},E=function(){var e=Object(K.a)(Q.a.mark((function e(){var n,t,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w.loading&&C()){e.next=2;break}return e.abrupt("return");case 2:"id"===w.lookupType?y("/advise/"+w.id):(S({type:"loading",payload:!0}),a={operating_system:{name:w.operating_system_name,version:w.operating_system_version},python_version:w.python_version,base_image:w.base_image,cuda_version:w.cuda_version,cudnn_version:w.cudnn_version,mkl_version:w.mkl_version,name:w.name,openblas_version:w.openblas_version,openmpi_version:w.openmpi_version},Object.keys(a).forEach((function(e){""===a[e]&&delete a[e]})),""!==(null===a||void 0===a||null===(n=a.operating_system)||void 0===n?void 0:n.name)&&""!==(null===a||void 0===a||null===(t=a.operating_system)||void 0===t?void 0:t.version)||delete a.operating_system,w.pipfile?w.pipfileLock?re(w.pipfile,w.pipfileLock,a).then((function(e){S({type:"loading",payload:!1}),y("/advise/"+e.data.analysis_id+"/summary")})).catch((function(e){var n,t,a,i,r,o,c,l,s;if(S({type:"loading",payload:!1}),400===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))if(null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&null!==(i=a.error)&&void 0!==i&&i.includes("Pipfile.lock"))S({type:"error",param:"pipfileLock",payload:null===e||void 0===e||null===(l=e.response)||void 0===l||null===(s=l.data)||void 0===s?void 0:s.error});else if(null!==e&&void 0!==e&&null!==(r=e.response)&&void 0!==r&&null!==(o=r.data)&&void 0!==o&&null!==(c=o.error)&&void 0!==c&&c.includes("Pipfile")){var d,u;S({type:"error",param:"pipfile",payload:null===e||void 0===e||null===(d=e.response)||void 0===d||null===(u=d.data)||void 0===u?void 0:u.error})}})):S({type:"error",param:"pipfileLock",payload:"Pipfile.lock is required"}):S({type:"error",param:"pipfile",payload:"Pipfile is required"}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(ue.a,{in:"id"===w.lookupType,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(N.a,{container:!0,justifyContent:"center",children:[Object(b.jsx)(N.a,{item:!0,xs:12,children:Object(b.jsx)(V.a,{color:"error",variant:"body1",sx:{minHeight:30},children:null===(e=w.error)||void 0===e?void 0:e.id})}),Object(b.jsxs)(N.a,{container:!0,item:!0,xs:12,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:12,md:10,children:Object(b.jsx)(X,{error:void 0!==(null===(n=w.error)||void 0===n?void 0:n.id),onChange:function(e){return S({type:"input",param:"id",payload:e.target.value})},helpertext:"Analysis ID",type:"search",boxprops:{marginRight:2},lefticon:Object(b.jsx)(ee.a,{}),onEnter:E})}),Object(b.jsx)(N.a,{item:!0,xs:12,md:2,children:Object(b.jsx)(d.a,{variant:"contained",color:"primary",onClick:function(){return E()},sx:{minHeight:"100%",minWidth:"100%"},children:Object(b.jsx)("b",{children:"Analyze"})})})]})]}),Object(b.jsx)(d.a,{onClick:function(){return S({type:"input",param:"lookupType",payload:"manual"})},children:"New Advise"})]})}),Object(b.jsx)(ue.a,{in:"manual"===w.lookupType,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(V.a,{variant:"h6",mt:3,mb:1,ml:2,children:"Advise Parameters"}),Object(b.jsxs)(J.a,{sx:{backgroundColor:"white",padding:3,marginBottom:5},variant:"outlined",children:[Object(b.jsxs)(N.a,{container:!0,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:12,md:6,children:Object(b.jsx)(X,{label:null!==(t=w.error)&&void 0!==t&&t.pipfile?null===(i=w.error)||void 0===i?void 0:i.pipfile:"Pipfile contents",onChange:function(e){return S({type:"input",param:"pipfile",payload:e.target.value})},error:void 0!==(null===(r=w.error)||void 0===r?void 0:r.pipfile),multiline:!0,rows:8})}),Object(b.jsx)(N.a,{item:!0,xs:12,md:6,children:Object(b.jsx)(X,{label:null!==(o=w.error)&&void 0!==o&&o.pipfileLock?null===(c=w.error)||void 0===c?void 0:c.pipfileLock:"Pipfile.lock contents",onChange:function(e){return S({type:"input",param:"pipfileLock",payload:e.target.value})},error:void 0!==(null===(l=w.error)||void 0===l?void 0:l.pipfileLock),multiline:!0,rows:8})})]}),Object(b.jsxs)(N.a,{container:!0,mt:4,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(ve.a,{onChange:function(e){return S({type:"input",param:"base_image",payload:e.target.value})},value:w.base_image,sx:{minWidth:"100%"},label:"Base Image",required:!1,helperText:"A base container image used to run the application.",error:void 0!==(null===(s=w.error)||void 0===s?void 0:s.base_image)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"cuda_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.cuda_version,suggestions:["9.0"],label:"CUDA Version",required:!1,help:"Nvidia CUDA version which the application uses.",error:void 0!==(null===(u=w.error)||void 0===u?void 0:u.cuda_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"cudnn_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.cudnn_version,suggestions:["8"],label:"cuDNN Version",required:!1,help:"NVIDIA cuDNN version used, if any.",error:void 0!==(null===(v=w.error)||void 0===v?void 0:v.cudnn_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"mkl_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.mkl_version,suggestions:["2021.1.1"],label:"MKL Version",required:!1,help:"Intel\xae Math Kernel Library version used, if any.",error:void 0!==(null===(j=w.error)||void 0===j?void 0:j.mkl_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"name",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.name,suggestions:["ubi:8-prod"],label:"Name",required:!0,help:"User defined name of the runtime environment.",error:void 0!==(null===(h=w.error)||void 0===h?void 0:h.name)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"openblas_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.openblas_version,suggestions:["0.3.13"],label:"OpenBLAS Version",required:!1,help:"OpenBLAS version used, if any.",error:void 0!==(null===(p=w.error)||void 0===p?void 0:p.openblas_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"openmpi_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.openmpi_version,suggestions:["4.1"],label:"Open MPI Version",required:!1,help:"Open MPI version used, if any.",error:void 0!==(null===(O=w.error)||void 0===O?void 0:O.openmpi_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(ve.a,{onChange:function(e){return S({type:"input",param:"operating_system_name",payload:e.target.value})},value:w.operating_system_name,sx:{minWidth:"100%"},label:"Operating System Name",required:!1,helperText:"Operating system name used.",error:void 0!==(null===(x=w.error)||void 0===x?void 0:x.operating_system_name)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(ve.a,{onChange:function(e){return S({type:"input",param:"operating_system_version",payload:e.target.value})},value:w.operating_system_version,sx:{minWidth:"100%"},label:"Operating System Version",required:!1,helperText:"Operating system version used.",error:void 0!==(null===(f=w.error)||void 0===f?void 0:f.operating_system_version)})}),Object(b.jsx)(N.a,{item:!0,xs:12,sm:6,md:4,children:Object(b.jsx)(me,{setValue:function(e){var n;return S({type:"input",param:"python_version",payload:null!==(n=null===e||void 0===e?void 0:e.title)&&void 0!==n?n:""})},value:w.python_version,suggestions:["2.7","3.6","3.7","3.8","3.9"],label:"Python Version",required:!1,help:"Python version on which the application runs on.",error:void 0!==(null===(g=w.error)||void 0===g?void 0:g.python_version)})}),Object(b.jsxs)(N.a,{container:!0,item:!0,xs:12,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:6,md:6,children:Object(b.jsx)(d.a,{variant:"outlined",color:"primary",onClick:function(){return S({type:"input",param:"lookupType",payload:"id"})},sx:{minHeight:"100%",minWidth:"100%"},children:Object(b.jsx)("b",{children:"Cancel"})})}),Object(b.jsx)(N.a,{item:!0,xs:6,children:Object(b.jsx)(je.a,{variant:"contained",color:"primary",onClick:function(){return E()},loading:w.loading,sx:{minHeight:"100%",minWidth:"100%"},children:Object(b.jsx)("b",{children:"Analyze"})})})]})]})]})]})})]})},ge=t(387),ye=t(388),ke=t(385),_e=t(386),we=t(383),Se=t(301),Ce=t(384),Ee=t(375);function Ae(e){var n=new Date,t=Math.floor((n.valueOf()-e.valueOf())/1e3),a=t/3154e4;if(a>1){var i=Math.floor(a);return i+" year"+(1!==i?"s":"")}if((a=t/2628e3)>1){var r=Math.floor(a);return r+" month"+(1!==r?"s":"")}if((a=t/86400)>1){var o=Math.floor(a);return o+" day"+(1!==o?"s":"")}if((a=t/3600)>1){var c=Math.floor(a);return c+" hour"+(1!==c?"s":"")}if((a=t/60)>1){var l=Math.floor(a);return l+" minute"+(1!==l?"s":"")}var s=Math.floor(t);return s+" second"+(1!==s?"s":"")}var Pe=t(200),Le=t.n(Pe),Me=t(82),Ie=t(308),Ne=function(){return Object(b.jsx)("div",{children:"404"})},Ve=[{id:"environment_name",label:"Image Name"},{id:"os_name",label:"OS Name"},{id:"os_version",label:"OS Version"},{id:"python_version",label:"Python Version"},{id:"datetime",label:"Last Updated"}];function De(e,n,t){return n[t]<e[t]?-1:n[t]>e[t]?1:0}function Re(e,n){return"desc"===e?function(e,t){return De(e,t,n)}:function(e,t){return-De(e,t,n)}}function Te(e){var n=e.order,t=e.orderBy,a=e.onRequestSort;return Object(b.jsx)(we.a,{children:Object(b.jsxs)(Ce.a,{children:[Ve.map((function(e){return Object(b.jsx)(ke.a,{sortDirection:t===e.id&&n,children:Object(b.jsx)(Ee.a,{active:t===e.id,direction:t===e.id?n:"asc",onClick:function(){return n=e.id,void a(n);var n},children:Object(b.jsx)("b",{children:e.label})})},e.id)})),Object(b.jsx)(ke.a,{})]})})}function Be(){var e,n=a.useState("asc"),t=Object(m.a)(n,2),i=t[0],r=t[1],o=a.useState("datetime"),c=Object(m.a)(o,2),s=c[0],d=c[1],u=a.useState(0),v=Object(m.a)(u,2),j=v[0],h=v[1],p=a.useState(10),O=Object(m.a)(p,2),x=O[0],f=O[1],g=Object(A.g)(),y=(e={useErrorBoundary:!1},Object(l.useQuery)(Object(F.a)(Object(F.a)({},e),{},{queryKey:["container-images"],queryFn:function(){return le()}}))),_=Object(a.useMemo)((function(){var e,n,t,a;return null!==y&&void 0!==y&&null!==(e=y.data)&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.container_images?null===y||void 0===y||null===(t=y.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.container_images.map((function(e){return Object(F.a)(Object(F.a)({},e),{},{date:Ae(new Date(e.datetime))+" ago"})})):[]}),[null===y||void 0===y?void 0:y.data]),w=j>0?Math.max(0,(1+j)*x-_.length):0;return y.isError?Object(b.jsx)(Ne,{}):_?Object(b.jsx)(k.a,{sx:{width:"100%"},children:Object(b.jsxs)(J.a,{sx:{width:"100%",mb:2},children:[Object(b.jsx)(_e.a,{children:Object(b.jsxs)(ge.a,{sx:{minWidth:750},size:"medium",children:[Object(b.jsx)(Te,{order:i,orderBy:s,onRequestSort:function(e){r(s===e&&"asc"===i?"desc":"asc"),d(e)},rowCount:_.length}),Object(b.jsxs)(ye.a,{children:[_.slice().sort(Re(i,s)).slice(j*x,j*x+x).map((function(e,n){var t,a="enhanced-table-checkbox-".concat(n);return Object(b.jsxs)(Ce.a,{hover:!0,tabIndex:-1,children:[Object(b.jsx)(ke.a,{component:"th",id:a,scope:"row",children:e.environment_name}),Object(b.jsx)(ke.a,{align:"left",children:e.os_name}),Object(b.jsx)(ke.a,{align:"left",children:e.os_version}),Object(b.jsx)(ke.a,{align:"left",children:e.python_version}),Object(b.jsx)(ke.a,{align:"left",children:e.date}),Object(b.jsx)(ke.a,{align:"right",children:Object(b.jsx)(Me.a,{onClick:function(){return n=e.package_extract_document_id,t=e.environment_name,void g("/image/"+n,{state:{image_name:t}});var n,t},children:Object(b.jsx)(Le.a,{})})})]},(null!==(t=null===e||void 0===e?void 0:e.environment_name)&&void 0!==t?t:"")+n)})),w>0&&Object(b.jsx)(Ce.a,{style:{height:53*w},children:Object(b.jsx)(ke.a,{colSpan:6})})]})]})}),Object(b.jsx)(Se.a,{rowsPerPageOptions:[10,25,50],component:"div",count:_.length,rowsPerPage:x,page:j,onPageChange:function(e,n){h(n)},onRowsPerPageChange:function(e){f(parseInt(e.target.value,10)),h(0)}})]})}):Object(b.jsx)("div",{className:"w-full h-48 flex justify-center items-center",children:Object(b.jsx)(Ie.a,{})})}function qe(e,n){var t;switch(n.type){case"loading":return Object(F.a)(Object(F.a)({},e),{},{loading:n.payload});case"error":return Object(F.a)(Object(F.a)({},e),{},{error:Object(F.a)(Object(F.a)({},e.error),{},Object(de.a)({},n.param,n.payload))});case"clear-error":return e.error={},e;case"input":return Object(F.a)(Object(F.a)({},e),{},(t={},Object(de.a)(t,n.param,n.payload),Object(de.a)(t,"error",Object(F.a)(Object(F.a)({},e.error),{},Object(de.a)({},n.param,void 0))),t));default:throw new Error("Image state dispatch error")}}var Fe={error:{},loading:!1,lookupType:"id",id:""},ze=function(){var e,n,t=Object(A.g)(),i=Object(a.useReducer)(qe,Fe),r=Object(m.a)(i,2),o=r[0],c=r[1],l=function(){var e=Object(K.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.loading){e.next=2;break}return e.abrupt("return");case 2:if(!o.id.includes("package-extract")){e.next=5;break}return t("/image/"+o.id),e.abrupt("return");case 5:c({type:"loading",payload:!0}),ce(o.id).then((function(e){c({type:"loading",payload:!1}),t("/image/"+e.data.analysis_id,{state:{image_name:o.id}})})).catch((function(e){var n,t,a,i;(c({type:"loading",payload:!1}),400===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status))&&c({type:"error",param:"id",payload:null!==(t=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.error)&&void 0!==t?t:"An unknown error occurred"})}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(ue.a,{in:"id"===o.lookupType,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(N.a,{container:!0,justifyContent:"center",children:[Object(b.jsx)(N.a,{item:!0,xs:12,children:Object(b.jsx)(V.a,{color:"error",variant:"body1",sx:{minHeight:30},children:null===(e=o.error)||void 0===e?void 0:e.id})}),Object(b.jsxs)(N.a,{container:!0,item:!0,xs:12,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:12,md:10,children:Object(b.jsx)(X,{error:void 0!=(null===(n=o.error)||void 0===n?void 0:n.id),onChange:function(e){return c({type:"input",param:"id",payload:e.target.value})},helpertext:"Analysis ID or image name",type:"search",boxprops:{mr:2},lefticon:Object(b.jsx)(ee.a,{}),onEnter:l})}),Object(b.jsx)(N.a,{item:!0,xs:12,md:2,children:Object(b.jsx)(d.a,{variant:"contained",color:"primary",onClick:l,sx:{minHeight:"100%",minWidth:"100%"},children:Object(b.jsx)("b",{children:"Analyze"})})})]})]}),Object(b.jsx)(d.a,{onClick:function(){return c({type:"input",param:"lookupType",payload:"lookup"})},children:"Lookup Thoth Images"})]})}),Object(b.jsx)(ue.a,{in:"lookup"===o.lookupType,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(V.a,{variant:"h6",mt:3,mb:1,ml:2,children:"Available Thoth Container Images"}),Object(b.jsx)(Be,{})]})})]})},We=function(){var e=Object(a.useState)("package"),n=Object(m.a)(e,2),t=n[0],i=n[1],r=Object(B.a)(),o=Object(q.a)(r.breakpoints.up("sm"));return Object(b.jsx)("div",{style:{maxWidth:"1000px",marginLeft:"auto",marginRight:"auto"},children:Object(b.jsxs)(N.a,{container:!0,justifyContent:"center",children:[Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(k.a,{sx:{marginTop:10},children:Object(b.jsx)("img",{alt:"Thoth Logo",src:G,height:o?300:"auto",width:"100%"})})}),Object(b.jsxs)(N.a,{container:!0,item:!0,justifyContent:"center",mt:5,spacing:0,children:[Object(b.jsx)(N.a,{item:!0,xs:12,alignItems:"left",mb:3,children:Object(b.jsx)(V.a,{variant:"h4",children:Object(b.jsx)("b",{children:"Thoth Search"})})}),Object(b.jsx)(N.a,{item:!0,xs:12,alignItems:"left",children:Object(b.jsx)(V.a,{variant:"subtitle1",children:"Thoth Search is a tool that runs analysis on a Python application. It utilizes package metadata and Thoth Adviser to analyse and recommend a software stack. You can run analysis on an entire Python application using a properly formatted Pipfile and Pipfile.lock. Alternatively, you can analyse a single Python package to see what Thoth knows about the package."})}),Object(b.jsx)(N.a,{item:!0,textAlign:"center",xs:12,mt:3,mb:4,children:Object(b.jsxs)(D.a,{value:t,exclusive:!0,onChange:function(e,n){n&&i(n)},size:o?"large":"small",children:[Object(b.jsx)(R.a,{value:"package",children:Object(b.jsx)("b",{children:"package"})}),Object(b.jsx)(R.a,{value:"environment",children:Object(b.jsx)("b",{children:"environment"})}),Object(b.jsx)(R.a,{value:"image",children:Object(b.jsx)("b",{children:"image"})})]})}),Object(b.jsxs)(N.a,{item:!0,xs:12,sx:{marginBottom:3},children:[Object(b.jsx)(T.a,{}),Object(b.jsx)(H,{value:t,index:"package",children:Object(b.jsx)(se,{})}),Object(b.jsx)(H,{value:t,index:"environment",children:Object(b.jsx)(fe,{})}),Object(b.jsx)(H,{value:t,index:"image",children:Object(b.jsx)(ze,{})})]})]})]})})},He=t(390),Ge=t(391),Ke=t(392),Ue=function(e){var n=e.cardMeta,t=e.cardBody,a=e.cardAction;return Object(b.jsxs)(He.a,{children:[Object(b.jsx)(Ge.a,{action:a,title:Object(b.jsx)(V.a,{variant:"h5",children:n.title}),subheader:n.subTitle}),Object(b.jsx)(Ke.a,{children:t})]})},Qe=t(225),Je=t(136),Ye=t.n(Je),Ze=t(137),Xe=t.n(Ze),$e=t(393),en=["text","icon","link"],nn=function(e){var n=e.text,t=e.icon,a=e.link,i=Object(z.a)(e,en);return Object(b.jsxs)(w.a,Object(F.a)(Object(F.a)({},i),{},{direction:"row",spacing:1,alignItems:"center",children:[t,Object(b.jsx)($e.a,{underline:"none",href:a||void 0,variant:"body2",align:"center",children:n})]}))},tn=t(371),an=["info"],rn=function(e){var n=e.info,t=Object(z.a)(e,an);return Object(b.jsx)(tn.a,Object(F.a)(Object(F.a)({action:Object(b.jsx)(d.a,{color:"inherit",size:"small",href:null===n||void 0===n?void 0:n.link,children:"DETAILS"}),severity:n.type},t),{},{children:null===n||void 0===n?void 0:n.message}))},on=function(e,n,t){return e?"Advise finished "+Ae(new Date(e))+" ago.":n?"Advise started "+Ae(new Date(n))+" ago.":t?"Advise finished "+Ae(new Date(t+"Z"))+" ago.":"Time started/finished not available"},cn=function(e){var n,t,r,o,c,l,s,u,v,j,h,p=e.adviseDocument,O=e.logs,x=i.a.useState(!1),f=Object(m.a)(x,2),g=f[0],y=f[1],k=i.a.useState(!1),_=Object(m.a)(k,2),S=_[0],C=_[1],E=i.a.useState(),A=Object(m.a)(E,2),P=A[0],L=A[1],M=Object(a.useMemo)((function(){var e,n,t;return null!==p&&void 0!==p&&null!==(e=p.result)&&void 0!==e&&e.report?p.result.report.ERROR?["ERROR","error"]:["COMPLETE","success"]:null!==p&&void 0!==p&&null!==(n=p.result)&&void 0!==n&&n.error?["ERROR","error"]:null!==p&&void 0!==p&&null!==(t=p.status)&&void 0!==t&&t.state?[p.status.state.toUpperCase(),"info"]:["UNKNOWN",void 0]}),[p]),I=Object(m.a)(M,2),N=I[0],D=I[1],R=Object(a.useMemo)((function(){var e,n,t;return null!==p&&void 0!==p&&null!==(e=p.result)&&void 0!==e&&null!==(n=e.report)&&void 0!==n&&n.stack_info?null===p||void 0===p||null===(t=p.result)||void 0===t?void 0:t.report.stack_info.filter((function(e){return"ERROR"===e.type})).map((function(e){return Object(F.a)(Object(F.a)({},e),{},{type:e.type.toLowerCase()})})):[]}),[p]);return Object(b.jsxs)("div",{children:[Object(b.jsx)(V.a,{variant:"h4",mb:1,children:Object(b.jsx)("b",{children:null!==(n=null===p||void 0===p||null===(t=p.metadata)||void 0===t?void 0:t.document_id)&&void 0!==n?n:null===p||void 0===p||null===(r=p.parameters)||void 0===r?void 0:r.analysis_id})}),Object(b.jsxs)(w.a,{direction:"row",spacing:2,alignItems:"center",mb:3,children:[Object(b.jsx)(Qe.a,{label:N,color:D}),Object(b.jsx)(nn,{text:on(null===p||void 0===p||null===(o=p.status)||void 0===o?void 0:o.finished_at,null===p||void 0===p||null===(c=p.status)||void 0===c?void 0:c.started_at,null===p||void 0===p||null===(l=p.metadata)||void 0===l?void 0:l.datetime),icon:Object(b.jsx)(Ye.a,{})}),Object(b.jsx)(d.a,{sx:{marginLeft:2},onClick:function(){return C(!S)},children:Object(b.jsx)(nn,{text:"Logs",icon:Object(b.jsx)(Xe.a,{})})})]}),Object(b.jsx)(ue.a,{in:S,children:null!==(s=null===O||void 0===O?void 0:O.split("\n").map((function(e,n){return Object(b.jsx)(V.a,{noWrap:P!==n,onClick:function(){return L(P===n?void 0:n)},variant:"body2",sx:{backgroundColor:P===n?"lightyellow":n%2===0?"lightgray":"unset"},children:e},n)})))&&void 0!==s?s:"Advisor log is not available."}),Object(b.jsx)(V.a,{variant:"subtitle2",mb:2,children:null!==(u=null===p||void 0===p||null===(v=p.result)||void 0===v||null===(j=v.report)||void 0===j?void 0:j.ERROR)&&void 0!==u?u:null===p||void 0===p||null===(h=p.result)||void 0===h?void 0:h.error_msg}),(null===R||void 0===R?void 0:R.length)>0?Object(b.jsxs)(w.a,{direction:"column",spacing:1,children:[Object(b.jsx)(rn,{info:R[0]}),Object(b.jsx)(ue.a,{in:g,timeout:"auto",unmountOnExit:!0,children:Object(b.jsx)(w.a,{direction:"column",spacing:1,children:null===R||void 0===R?void 0:R.slice(1).map((function(e,n){return Object(b.jsx)(rn,{info:e},n)}))})}),Object(b.jsx)(d.a,{color:"inherit",size:"small",sx:{alignSelf:"flex-start"},onClick:function(){return y(!g)},children:(null===R||void 0===R?void 0:R.length)>1?g?"LESS":"MORE":null})]}):null,"COMPLETE"===N?Object(b.jsxs)(V.a,{variant:"body1",sx:{color:"text.secondary"},children:["Thoth has added and removed packages from the original Pipfile.lock, resulting in a ",Object(b.jsx)("i",{children:"new"})," Pipfile.lock. Switch between the new and old Python environments to see the differences."]}):null]})},ln=function(e){var n=e.value,t=e.onChange;return Object(b.jsxs)(D.a,{value:n,exclusive:!0,size:"small",onChange:t,children:[Object(b.jsx)(R.a,{value:"oldGraph",children:"Old"}),Object(b.jsx)(R.a,{value:"newGraph",children:"New"})]})},sn=t(204),dn=t.n(sn),un=t(203),vn=t.n(un),jn=t(205),bn=t.n(jn);function hn(e,n,t){return n[t]<e[t]?-1:n[t]>e[t]?1:0}function pn(e,n){return"desc"===e?function(e,t){return hn(e,t,n)}:function(e,t){return-hn(e,t,n)}}function mn(e,n){var t=e.map((function(e,n){return[e,n]}));return t.sort((function(e,t){var a=n(e[0],t[0]);return 0!==a?a:e[1]-t[1]})),t.map((function(e){return e[0]}))}var On=t(368),xn=[{id:"name",numeric:!1,label:"Package"},{id:"depth",numeric:!0,label:"Depth"},{id:"license",numeric:!1,label:"License"},{id:"dependencies",numeric:!0,label:"Direct Dependencies"}];var fn=function(e){var n=e.order,t=e.orderBy,a=e.onRequestSort;return Object(b.jsx)(we.a,{children:Object(b.jsx)(Ce.a,{children:xn.map((function(e){return Object(b.jsx)(ke.a,{align:e.numeric?"right":"left",padding:"normal",sortDirection:t===e.id&&n,children:Object(b.jsxs)(Ee.a,{active:t===e.id,direction:t===e.id?n:"asc",onClick:function(){return n=e.id,void a(n);var n},children:[e.label,t===e.id?Object(b.jsx)(k.a,{component:"span",sx:On.a,children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},e.id)}))})})},gn=i.a.createContext({}),yn=function(e){var n=e.mergedGraph,t=Object(a.useState)(""),i=Object(m.a)(t,2),r=i[0],o=i[1],c=Object(a.useState)(""),l=Object(m.a)(c,2),s=l[0],d=l[1];return n?Object(b.jsx)(gn.Provider,{value:{selected:s,setSelected:d},children:Object(b.jsxs)(N.a,{container:!0,spacing:2,justifyContent:"center",alignItems:"flex-start",mt:2,children:[Object(b.jsx)(N.a,{item:!0,sm:12,md:6,children:Object(b.jsxs)(J.a,{sx:{padding:2},children:[Object(b.jsx)(X,{onChange:function(e){o(e.target.value)},lefticon:Object(b.jsx)(ee.a,{})}),Object(b.jsx)(kn,{search:r,filteredGraph:n})]})}),Object(b.jsx)(N.a,{item:!0,sm:12,md:6,children:s?Object(b.jsx)(Vn,{mergedGraph:n}):Object(b.jsx)(V.a,{variant:"body1",align:"center",children:"No package selected"})})]})}):null};function kn(e){var n,t=e.search,r=void 0===t?"":t,o=e.filteredGraph,c=Object(a.useState)("asc"),l=Object(m.a)(c,2),s=l[0],d=l[1],u=i.a.useState("name"),v=Object(m.a)(u,2),j=v[0],h=v[1],p=i.a.useState(0),O=Object(m.a)(p,2),x=O[0],f=O[1],g=i.a.useState(25),y=Object(m.a)(g,2),_=y[0],w=y[1],S=i.a.useState([]),C=Object(m.a)(S,2),E=C[0],A=C[1],P=null!==(n=Object(a.useContext)(gn))&&void 0!==n?n:{setSelected:function(){return console.log("missing callback")}},L=P.selected,M=P.setSelected;Object(a.useEffect)((function(){if(o){f(0);var e=[];o.nodes.forEach((function(n){var t,a,i,r,o,c,l,s,d,u;-1!==n.value.depth&&e.push({name:null!==(t=n.value.label)&&void 0!==t?t:n.key,key:n.key,warnings:[],depth:null!==(a=null===(i=n.value)||void 0===i?void 0:i.depth)&&void 0!==a?a:-1,license:null!==(r=null===n||void 0===n||null===(o=n.value)||void 0===o||null===(c=o.metadata)||void 0===c?void 0:c.License)&&void 0!==r?r:"",dependencies:n.adjacents.size,change:null===(l=n.value)||void 0===l?void 0:l.change,summary:null!==(s=null===n||void 0===n||null===(d=n.value)||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.Summary)&&void 0!==s?s:""})})),A(e)}}),[o]);var I=x>0?Math.max(0,(1+x)*_-E.length):0;return Object(b.jsxs)(k.a,{sx:{width:"100%"},children:[Object(b.jsx)(_e.a,{children:Object(b.jsxs)(ge.a,{sx:{minWidth:750},size:"medium",children:[Object(b.jsx)(fn,{order:s,orderBy:j,onRequestSort:function(e){d(j===e&&"asc"===s?"desc":"asc"),h(e)}}),Object(b.jsxs)(ye.a,{children:[mn(E,pn(s,j)).filter((function(e){return e.name.includes(r)})).slice(x*_,x*_+_).map((function(e,n){var t="enhanced-table-checkbox-".concat(n),a="removed"===e.change?"error":"added"===e.change?"success":void 0;return Object(b.jsxs)(i.a.Fragment,{children:[Object(b.jsxs)(Ce.a,{hover:!0,onClick:function(){return M(e.key)},tabIndex:-1,selected:L===e.key,children:[Object(b.jsx)(ke.a,{component:"th",id:t,scope:"row",children:Object(b.jsxs)(k.a,{display:"flex",children:["removed"===e.change?Object(b.jsx)(vn.a,{color:a}):"added"===e.change?Object(b.jsx)(dn.a,{color:a}):Object(b.jsx)(bn.a,{}),Object(b.jsx)(V.a,{ml:2,children:e.name})]})}),Object(b.jsx)(ke.a,{align:"right",children:e.depth}),Object(b.jsx)(ke.a,{align:"right",children:e.license}),Object(b.jsx)(ke.a,{align:"right",children:e.dependencies})]}),Object(b.jsx)(Ce.a,{children:Object(b.jsx)(ke.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6})})]},e.name)})),I>0&&Object(b.jsx)(Ce.a,{style:{height:53*I},children:Object(b.jsx)(ke.a,{colSpan:6})})]})]})}),Object(b.jsx)(Se.a,{rowsPerPageOptions:[5,10,25],component:"div",count:E.length,rowsPerPage:_,page:x,onPageChange:function(e,n){f(n)},onRowsPerPageChange:function(e){w(parseInt(e.target.value,10)),f(0)}})]})}var _n=t(105),wn=t.n(_n),Sn=t(206),Cn=t.n(Sn),En=function(e){var n,t,a,i,r,o,c,l,s,d,u=e.node;return Object(b.jsxs)("div",{children:[Object(b.jsxs)(N.a,{container:!0,alignItems:"center",children:[Object(b.jsx)(N.a,{item:!0,xs:6,children:Object(b.jsx)(V.a,{variant:"h6",children:Object(b.jsx)("b",{children:u.value.id})})}),Object(b.jsx)(N.a,{item:!0,xs:6,children:Object(b.jsxs)(V.a,{ml:2,variant:"body1",children:["v",null!==(n=u.value.version)&&void 0!==n?n:"NaN"]})})]}),Object(b.jsx)(V.a,{gutterBottom:!0,variant:"body2",children:null!==(t=null===(a=u.value)||void 0===a||null===(i=a.metadata)||void 0===i?void 0:i.Summary)&&void 0!==t?t:"NaN"}),Object(b.jsxs)(N.a,{container:!0,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(nn,{text:null!==(r=null===(o=u.value)||void 0===o||null===(c=o.metadata)||void 0===c?void 0:c.License)&&void 0!==r?r:"NaN",icon:Object(b.jsx)(wn.a,{})})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(nn,{ml:2,text:null!==(l=u.value)&&void 0!==l&&l.latestVersion?"Latest version is installed":"Installed version is NOT the latest.",icon:Object(b.jsx)(Cn.a,{})})})]}),Object(b.jsx)(V.a,{variant:"body2",mt:2,children:null===(s=u.value)||void 0===s||null===(d=s.justifications)||void 0===d?void 0:d.header})]})},An=t(143),Pn=["mergedGraph"],Ln=function(e){var n=e.mergedGraph,t=Object(z.a)(e,Pn),i=Object(a.useRef)(null),r=Object(a.useContext)(gn).selected;return Object(a.useEffect)((function(){if(r&&n){var e=n.nodes.get(r);if(e){var t,a,c=n.findAllNodesOnAllPaths(e,"*App"),l=n.nodes.get("*App");l&&c.set("*App",l);var s=new An.a;c.forEach((function(n){var t,a=document.createElement("div");o.a.render(Object(b.jsx)(En,{node:n}),a);var i=null!==(t=n.value.color)&&void 0!==t?t:ie.nodes.color.background,r=void 0;"*App"===n.key?(i="#4fc1ea",r={color:"#4fc1ea",strokeWidth:3,size:20}):n.key===e.key&&(i="#f39200"),s.add(Object(F.a)(Object(F.a)({},n.value),{},{color:i,title:n.key===e.key||"*App"===n.key?void 0:a,font:r}))}));var d={nodes:s,edges:new An.a(n.visEdges)},u=i.current&&new An.b(i.current,d,ie),v=null===(t=document)||void 0===t||null===(a=t.getElementById("mynetwork"))||void 0===a?void 0:a.getElementsByTagName("canvas")[0],j=function(e){v&&(v.style.cursor=e)};u&&(u.on("hoverNode",(function(){j("grab")})),u.on("blurNode",(function(){j("default")})),u.on("dragStart",(function(){j("grabbing")})),u.on("dragging",(function(){j("grabbing")})),u.on("dragEnd",(function(){j("grab")})))}}}),[r,n,i]),Object(b.jsx)("div",Object(F.a)(Object(F.a)({},t),{},{style:{display:"flex",flexFlow:"column nowrap"},children:Object(b.jsx)("div",{ref:i,id:"mynetwork",style:{flex:"1 1 auto",height:"50vh"}})}))},Mn=t(17),In=t(207),Nn=t.n(In),Vn=function(e){var n,t,r,o,c,l,s,u,v,j,h,p,O,x,f,g,y,_,S,C,E,A=e.mergedGraph,P=Object(a.useContext)(gn),L=P.selected,M=P.setSelected,I=Object(a.useMemo)((function(){return A.nodes.get(L)}),[L]),D=Object(a.useMemo)((function(){var e={removed:[],added:[],version:[],unchanged:[]};return I&&Object(Mn.a)(I.parents).filter((function(e){return"*App"!==e})).forEach((function(n){var t=A.nodes.get(n);t&&e[t.value.change].push(n)})),e}),[I]),R=Object(a.useMemo)((function(){var e,n,t,a={};I&&(null===I||void 0===I||null===(e=I.value)||void 0===e||null===(n=e.justifications)||void 0===n||null===(t=n.thoth)||void 0===t||t.forEach((function(e){var n;a[e.type]=[].concat(Object(Mn.a)(null!==(n=a[e.type])&&void 0!==n?n:[]),[e])})));return a}),[I]),T=Object(a.useMemo)((function(){return Object(b.jsxs)(w.a,{direction:"row",alignItems:"center",children:[Object(b.jsx)(Nn.a,{color:"error",sx:{marginRight:".5rem"}}),Object(b.jsx)(V.a,{mb:0,color:"error",gutterBottom:!0,variant:"body2",children:"The package metadata could not be fetched. Package data will be limited."})]})}),[]);return Object(b.jsxs)(k.a,{children:[Object(b.jsxs)(J.a,{sx:{padding:2},children:[Object(b.jsxs)(N.a,{container:!0,alignItems:"center",mb:1,children:[Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(V.a,{variant:"h3",children:Object(b.jsx)("b",{children:null===I||void 0===I||null===(n=I.value)||void 0===n?void 0:n.name})})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(V.a,{ml:2,variant:"h6",children:null===I||void 0===I||null===(t=I.value)||void 0===t?void 0:t.version})})]}),!(null!==I&&void 0!==I&&null!==(r=I.value)&&void 0!==r&&r.metadata)&&T,Object(b.jsx)(V.a,{gutterBottom:!0,variant:"body1",children:null===I||void 0===I||null===(o=I.value)||void 0===o||null===(c=o.metadata)||void 0===c?void 0:c.Summary}),Object(b.jsx)(N.a,{container:!0,spacing:2,children:Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(nn,{text:null!==(l=null===I||void 0===I||null===(s=I.value)||void 0===s||null===(u=s.metadata)||void 0===u?void 0:u.License)&&void 0!==l?l:"NaN",icon:Object(b.jsx)(wn.a,{})})})})]}),Object(b.jsxs)(J.a,{sx:{padding:2,marginTop:2},children:[Object(b.jsx)(V.a,{variant:"h5",children:"Thoth Justifications"}),Object(b.jsx)(V.a,{variant:"body1",mt:2,children:null===I||void 0===I||null===(v=I.value)||void 0===v||null===(j=v.justifications)||void 0===j?void 0:j.header}),null!==I&&void 0!==I&&null!==(h=I.value)&&void 0!==h&&null!==(p=h.justifications)&&void 0!==p&&null!==(O=p.reasons)&&void 0!==O&&O.length?Object(b.jsx)("ul",{children:null===I||void 0===I||null===(x=I.value)||void 0===x||null===(f=x.justifications)||void 0===f?void 0:f.reasons.map((function(e,n){return Object(b.jsx)("li",{children:Object(b.jsxs)(V.a,{variant:"body1",mt:2,children:[Object(b.jsx)($e.a,{underline:"hover",onClick:function(){return M(e.package)},children:e.package}),e.reason]})},n+e.reason)}))}):null,Object.entries(R).map((function(e){var n=Object(m.a)(e,2),t=n[0],a=n[1];return Object(b.jsxs)(i.a.Fragment,{children:[Object(b.jsxs)(V.a,{variant:"h6",mt:2,children:[t," Justifications"]}),a.map((function(e,n){return Object(b.jsxs)(N.a,{container:!0,alignItems:"center",ml:3,children:[Object(b.jsx)(N.a,{item:!0,xs:10,children:Object(b.jsx)(V.a,{variant:"body1",mt:1,children:e.message})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(d.a,{href:e.link,children:"READ MORE"})})]},e.message+n)}))]},t)}))]}),Object(b.jsxs)(J.a,{sx:{padding:2,marginTop:2},children:[Object(b.jsx)(V.a,{variant:"h5",mb:2,children:"Package Origins"}),Object(b.jsxs)(V.a,{variant:"body1",mb:2,children:[0===(null===(g=Object(Mn.a)(null!==(y=null===I||void 0===I?void 0:I.parents)&&void 0!==y?y:[]).filter((function(e){return"*App"!==e})))||void 0===g?void 0:g.length)?(null===I||void 0===I||null===(_=I.value)||void 0===_?void 0:_.label)+" is not a dependent of any package in this Python environment":"There are "+(null===(S=Object(Mn.a)(null!==(C=null===I||void 0===I?void 0:I.parents)&&void 0!==C?C:[]).filter((function(e){return"*App"!==e})))||void 0===S?void 0:S.length)+" package(s) that have "+(null===I||void 0===I||null===(E=I.value)||void 0===E?void 0:E.label)+" as a direct dependency. Of those package(s)",Object.keys(D).map((function(e,n){return 0===D[e].length?null:Object(b.jsxs)(i.a.Fragment,{children:[", "+D[e].length+("version"===e?" had a version change ":(1===D[e].length?" was ":" were ")+e)+" (",D[e].map((function(e,n,t){var a=e;return n!==t.length-1&&(a+=", "),Object(b.jsx)($e.a,{underline:"hover",onClick:function(){return M(e)},children:a},n+a)})),")"]},e+n)})),"."]}),Object(b.jsx)(Ln,{mergedGraph:A})]})]})},Dn=t(395),Rn=t(377),Tn=t(381),Bn=t(373),qn=t(369),Fn=t(394),zn=["value","total","label","action"],Wn=function(e){var n=e.value,t=e.total,a=e.label,i=e.action,r=Object(z.a)(e,zn);return Object(b.jsxs)(N.a,Object(F.a)(Object(F.a)({container:!0,spacing:1,alignItems:"center"},r),{},{children:[Object(b.jsx)(N.a,{item:!0,xs:5,children:Object(b.jsx)(V.a,{variant:"body2",children:a})}),Object(b.jsx)(N.a,{item:!0,xs:2,children:Object(b.jsx)(V.a,{variant:"body2",children:n})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(Fn.a,{variant:"determinate",value:t>0?n/t*100:0,sx:{root:{height:10,borderRadius:5},colorPrimary:{backgroundColor:"theme.palette.grey[200]"},bar:{borderRadius:5,backgroundColor:"#1a90ff"}}})}),Object(b.jsx)(N.a,{item:!0,xs:1,children:Object(b.jsx)("div",{children:null!==i&&void 0!==i?i:null})})]}))},Hn=function(e){var n,t,a,i,r,o,c,l,s,d,u,v,j,h,p=e.metric,O=(null!==(n=null===p||void 0===p||null===(t=p.all)||void 0===t?void 0:t.direct)&&void 0!==n?n:0)+(null!==(a=null===p||void 0===p||null===(i=p.all)||void 0===i?void 0:i.indirect)&&void 0!==a?a:0)+(null!==(r=null===p||void 0===p||null===(o=p.all)||void 0===o?void 0:o.roots)&&void 0!==r?r:0);return null!==p&&void 0!==p&&p.all&&null!==p&&void 0!==p&&p.roots?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"All Packages"}),Object(b.jsx)(T.a,{sx:{mb:1}}),Object(b.jsx)(Wn,{value:null!==(c=null===p||void 0===p||null===(l=p.all)||void 0===l?void 0:l.roots)&&void 0!==c?c:0,total:O,label:"Root",mb:1}),Object(b.jsx)(Wn,{value:null!==(s=null===p||void 0===p||null===(d=p.all)||void 0===d?void 0:d.direct)&&void 0!==s?s:0,total:O,label:"Direct",mb:1}),Object(b.jsx)(Wn,{value:null!==(u=null===p||void 0===p||null===(v=p.all)||void 0===v?void 0:v.indirect)&&void 0!==u?u:0,total:O,label:"Indirect"}),Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,mt:2,children:"Root Packages"}),Object(b.jsx)(T.a,{sx:{mb:1}}),Object(b.jsx)(Tn.a,{component:"nav",children:Object(b.jsx)(Dn.a,{children:null===(j=Object.entries(null!==(h=null===p||void 0===p?void 0:p.roots)&&void 0!==h?h:{}))||void 0===j?void 0:j.map((function(e){var n,t,a,i,r,o,c,l,s=Object(m.a)(e,1)[0],d=(null!==(n=null===p||void 0===p?void 0:p.roots[s].direct)&&void 0!==n?n:0)+(null!==(t=null===p||void 0===p?void 0:p.roots[s].indirect)&&void 0!==t?t:0);return Object(b.jsx)(ue.a,{children:Object(b.jsxs)("div",{children:[Object(b.jsx)(Bn.a,{children:Object(b.jsxs)(N.a,{container:!0,alignItems:"center",children:[Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(qn.a,{primary:s})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsxs)(N.a,{container:!0,direction:"column",children:[Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(Wn,{value:null!==(a=null===p||void 0===p||null===(i=p.roots)||void 0===i||null===(r=i[s])||void 0===r?void 0:r.direct)&&void 0!==a?a:0,total:d,label:"Direct"})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(Wn,{value:null!==(o=null===p||void 0===p||null===(c=p.roots)||void 0===c||null===(l=c[s])||void 0===l?void 0:l.indirect)&&void 0!==o?o:0,total:d,label:"Indirect"})})]})})]})}),Object(b.jsx)(T.a,{variant:"middle",sx:{mb:1}})]})},s)}))})})]}):Object(b.jsxs)(k.a,{children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Gn=t(210),Kn=t.n(Gn),Un=t(211),Qn=t.n(Un),Jn=t(209),Yn=t.n(Jn),Zn=t(208),Xn=t.n(Zn),$n=function(e){var n,t=e.name,a=e.metadata,r=e.packages,o=e.totalLicenses,c=i.a.useState(!1),l=Object(m.a)(c,2),s=l[0],d=l[1];return Object(b.jsxs)(N.a,{container:!0,children:[Object(b.jsx)(N.a,{item:!0,xs:1,children:null===(null===a||void 0===a?void 0:a.isOsiApproved)?Object(b.jsx)(Xn.a,{}):null!==a&&void 0!==a&&a.isOsiApproved?Object(b.jsx)(Yn.a,{}):null}),Object(b.jsxs)(N.a,{item:!0,xs:!0,children:[Object(b.jsx)(k.a,{onClick:function(){return d(!s)},children:Object(b.jsx)(Wn,{value:null!==(n=Object.keys(r).length)&&void 0!==n?n:0,total:o,label:t,action:s?Object(b.jsx)(Kn.a,{}):Object(b.jsx)(Qn.a,{})},t)}),Object(b.jsxs)(ue.a,{in:s,timeout:"auto",unmountOnExit:!0,children:[Object(b.jsx)(k.a,{my:1,children:Object.entries(r).sort((function(e,n){return e[1].depth-n[1].depth})).map((function(e){var n=Object(m.a)(e,2),t=n[0],a=n[1];return Object(b.jsx)(Qe.a,{sx:{margin:.5},color:0===a.depth?"primary":1===a.depth?"secondary":"default",label:t},t)}))}),Object(b.jsx)(T.a,{})]})]})]})},et=function(e){var n=e.metric,t=i.a.useState(!1),r=Object(m.a)(t,2),o=r[0],c=r[1],l=Object(a.useMemo)((function(){return Object.entries(null!==n&&void 0!==n?n:{}).sort((function(e,n){return Object.keys(n[1]).length-Object.keys(e[1]).length}))}),[n]),s=Object(a.useMemo)((function(){return Object.entries(null!==n&&void 0!==n?n:{}).reduce((function(e,n){var t=Object(m.a)(n,2)[1];return e+Object.keys(t.packages).length}),0)}),[n]);return n?Object(b.jsxs)("div",{children:[Object(b.jsxs)(N.a,{container:!0,children:[Object(b.jsx)(N.a,{item:!0,xs:1,children:Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"OSI"})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"Dependency Licenses"})})]}),Object(b.jsx)(T.a,{}),Object(b.jsx)(Dn.a,{children:null===l||void 0===l?void 0:l.slice(0,10).map((function(e){var n=Object(m.a)(e,2),t=n[0],a=n[1];return Object(b.jsx)(ue.a,{children:Object(b.jsx)($n,{name:t,metadata:a.metadata,packages:a.packages,totalLicenses:s})},t)}))}),Object(b.jsx)(ue.a,{in:o,timeout:"auto",unmountOnExit:!0,children:Object(b.jsx)(Dn.a,{children:l.slice(10).map((function(e){var n=Object(m.a)(e,2),t=n[0],a=n[1];return Object(b.jsx)(ue.a,{children:Object(b.jsx)($n,{name:t,metadata:a.metadata,packages:a.packages,totalLicenses:s})},t)}))})}),Object(b.jsx)(k.a,{textAlign:"center",children:Object(b.jsx)(d.a,{onClick:function(){return c(!o)},color:"primary",children:o?"Less":"More"})})]}):Object(b.jsxs)(k.a,{children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},nt=function(e){var n,t,a,i,r,o=e.metric,c=o?o.added+o.removed+o.version+o.unchanged:0,l=Object.values(null!==(n=null===o||void 0===o?void 0:o.justification)&&void 0!==n?n:{}).reduce((function(e,n){return e+n}),0);return o?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(V.a,{variant:"body2",gutterBottom:!0,children:null===o||void 0===o?void 0:o.build}),Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,mt:2,children:"What Thoth Changed"}),Object(b.jsx)(T.a,{sx:{mb:1}}),Object(b.jsx)(Wn,{value:null!==(t=null===o||void 0===o?void 0:o.added)&&void 0!==t?t:0,total:c,label:"Added Packages",sx:{mb:1}}),Object(b.jsx)(Wn,{value:null!==(a=null===o||void 0===o?void 0:o.removed)&&void 0!==a?a:0,total:c,label:"Removed Packages",sx:{mb:1}}),Object(b.jsx)(Wn,{value:null!==(i=null===o||void 0===o?void 0:o.version)&&void 0!==i?i:0,total:c,label:"Version Changes"}),Object(b.jsx)(V.a,{variant:"h6",mt:3,gutterBottom:!0,children:"Justification Counts"}),Object(b.jsx)(T.a,{sx:{mb:1}}),Object.entries(null!==(r=null===o||void 0===o?void 0:o.justification)&&void 0!==r?r:{}).map((function(e){var n=Object(m.a)(e,2),t=n[0],a=n[1];return Object(b.jsx)(Wn,{value:a,total:l,label:t,mb:1},t)}))]}):Object(b.jsxs)(k.a,{children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},tt=t(397),at=function(e){var n,t,a=e.metrics,r=i.a.useState("newGraph"),o=Object(m.a)(r,2),c=o[0],l=o[1],s=function(e,n){""!==n&&l(n)};return Object(b.jsxs)(tt.a,{columns:{xs:1,md:2},spacing:3,sx:{mb:3,mt:1},children:[Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Thoth Advise Summary"},cardBody:Object(b.jsx)(nt,{metric:null===a||void 0===a?void 0:a.advise})})}),Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Dependencies Summary"},cardBody:Object(b.jsx)(Hn,{metric:null===a||void 0===a||null===(n=a[c])||void 0===n?void 0:n.dependencies}),cardAction:Object(b.jsx)(ln,{value:c,onChange:s})})}),Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Licenses Summary"},cardBody:Object(b.jsx)(et,{metric:null===a||void 0===a||null===(t=a[c])||void 0===t?void 0:t.licenses}),cardAction:Object(b.jsx)(ln,{value:c,onChange:s})})})]})},it=function(e,n){return Object(l.useQuery)(Object(F.a)(Object(F.a)({},n),{},{queryKey:["adviseDocument",e],queryFn:function(){return function(e){return te.a.get(ae+"/advise/python/"+e,{headers:{accept:"application/json"}})}(e)}}))},rt=function(){var e=Object(K.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.get(ae+"/advise/python/"+n+"/log",{headers:{accept:"application/json"}}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function ot(e){return Object.entries(e.requirements_locked.default).map((function(n){var t,a,i,r,o,c,l,s,d=Object(m.a)(n,2);return{name:d[0],version:d[1].version.replace("==",""),index:"https://pypi.org/simple",os_name:null!==(t=null===e||void 0===e||null===(a=e.runtime_environment)||void 0===a||null===(i=a.operating_system)||void 0===i?void 0:i.name)&&void 0!==t?t:"",os_version:null!==(r=null===e||void 0===e||null===(o=e.runtime_environment)||void 0===o||null===(c=o.operating_system)||void 0===c?void 0:c.version)&&void 0!==r?r:"",python_version:null!==(l=null===e||void 0===e||null===(s=e.runtime_environment)||void 0===s?void 0:s.python_version)&&void 0!==l?l:""}}))}var ct=t(131),lt=t(63),st=t(64),dt=function(){function e(){Object(lt.a)(this,e),this.nodes=void 0,this.nodes=new Map}return Object(st.a)(e,[{key:"addVertex",value:function(e,n,t){var a=this.nodes.get(e);return a||(a=new t(e,n),this.nodes.set(e,a),a)}},{key:"addEdge",value:function(e,n){var t=this.nodes.get(e),a=this.nodes.get(n);return t&&a&&t.addAdjacent(a),[t,a]}},{key:"graphSearch",value:Q.a.mark((function e(n){var t,a,i,r,o=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>1&&void 0!==o[1]?o[1]:"bfs",a=new Set,(i=[]).push(n);case 4:if(0===i.length){e.next=13;break}if(!(r="dfs"===t?i.pop():i.shift())||a.has(r)){e.next=11;break}return e.next=9,r;case 9:a.add(r),r.getAdjacents().forEach((function(e){return i.push(e)}));case 11:e.next=4;break;case 13:case"end":return e.stop()}}),e)}))},{key:"findPath",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,a=this.nodes.get(e),i=this.nodes.get(n),r=new Set(t);if(!i||!a)return[];if(r.add(a),e===n)return Array.from(r);var o,c=Object(ct.a)(a.getAdjacents());try{for(c.s();!(o=c.n()).done;){var l=o.value;if(!r.has(l)){var s=this.findPath(l.key,n,r);if(s.length)return s}}}catch(d){c.e(d)}finally{c.f()}return[]}},{key:"findAllNodesOnAllPaths",value:function(e,n){var t=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,i=[];for(i.push(e);0!==i.length;){var r=i.pop();r&&r.key===n||r&&!a.has(r.key)&&(a.set(r.key,r),r.parents.forEach((function(e){return i.push(t.nodes.get(e))})))}return a}},{key:"findAllPaths",value:function(e,n){var t=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,i=this.nodes.get(e),r=this.nodes.get(n),o=new Set(a);if(!r||!i)return[];if(o.add(i),e===n)return[Array.from(o)];var c=[];return i.getAdjacents().forEach((function(e){o.has(e)||t.findAllPaths(e.key,n,o).forEach((function(e){c.push(e)}))})),c}}]),e}(),ut=function(e,n){if(e&&n){var t=new Map;n.forEach((function(e){e.package_name&&(t.has(e.package_name)?t.set(e.package_name,[].concat(Object(Mn.a)(t.get(e.package_name)),[e])):t.set(e.package_name,[e]))})),e.forEach((function(n){var a={package:n.key,header:"",reasons:[]};if("removed"===n.value.change?(a.header="".concat(n.value.label," was ").concat(0===n.value.depth?"directly":"indirectly"," removed by Thoth resolver."),a.reasons=function(e,n){var t=new Set,a=[];a.push(e);for(var i=[],r=function(){var r=a.pop();r&&!t.has(r)&&(t.add(r),"version"===r.value.change?i.push(r):r.parents.forEach((function(t){"*App"!==t?a.push(n.find((function(e){return e.key===t}))):r.key!==e.key&&i.push(r)})))};0!==a.length;)r();return i.map((function(n){var t="version"===n.value.change?" had its version changed to "+n.value.version+" from "+n.value.oldVersion+". Version "+n.value.oldVersion+" of "+n.key+" included package "+e.value.label+" as a dependency, where version "+n.value.version+" does not. ":" did not have any dependents and was removed by the Thoth resolver.";return{package:n.key,reason:t}}))}(n,e),0===a.reasons.length&&(a.header="".concat(n.value.label," was removed for an unknown reason. The package does not have dependents in the Pipfile.lock."))):"added"===n.value.change?a.header="".concat(n.value.label," was added to the Pipfile.lock by Thoth resolver."):"version"===n.value.change?a.header="".concat(n.key," had its version changed from ").concat(n.value.oldVersion," to ").concat(n.value.version,"."):a.header="Thoth resolver did not remove or change package "+n.value.label+".",t.has(n.key)){var i=t.get(n.key);a=Object(F.a)(Object(F.a)({},a),{},{thoth:i})}n.value.justifications=a}),[])}},vt=function(e){var n=Object(a.useState)(),t=Object(m.a)(n,2),i=t[0],r=t[1];return Object(a.useEffect)((function(){if(e){var n={all:{},roots:{}},t=[];e.nodes.forEach((function(e){0===e.value.depth&&t.push(e.key)}));var a=new Set;t.forEach((function(t){var i=e.nodes.get(t);if(i){var r=e.graphSearch(i);Array.from(r).forEach((function(e){var i;if("*App"!==e.key&&!a.has(e.value.id)){a.add(e.value.id);var r,o,c,l=0===e.value.depth?"roots":1===e.value.depth?"direct":"indirect";if(n.all[l]=(null!==(i=n.all[l])&&void 0!==i?i:0)+1,"roots"!==l)n.roots[t]||(n.roots[t]={}),n.roots[t][l]=(null!==(r=null===(o=n.roots)||void 0===o||null===(c=o[t])||void 0===c?void 0:c[l])&&void 0!==r?r:0)+1}}))}})),r(n)}}),[e]),i},jt=function(e){var n=Object(a.useState)(),t=Object(m.a)(n,2),i=t[0],r=t[1];return Object(a.useEffect)((function(){if(e){var n={},t=[];e.nodes.forEach((function(e){0===e.value.depth&&t.push(e.key)}));var a=new Set;t.forEach((function(t){var i=e.nodes.get(t);if(i){var r=e.graphSearch(i);Array.from(r).forEach((function(e){var t,i,r;if("*App"!==e.key&&!a.has(e.value.id)){a.add(e.value.id);var o,c,l,s,d,u,v=[];if(null===e||void 0===e||null===(t=e.value)||void 0===t||null===(i=t.metadata)||void 0===i||null===(r=i.Classifier)||void 0===r||r.forEach((function(n){var t,a,i,r,o,c,l=n.split(" :: ");"License"===l[0]&&("OSI Approved"===l[1]?v.push({generalLicense:null!==(t=null===l||void 0===l?void 0:l[2])&&void 0!==t?t:null===(a=e.value.metadata)||void 0===a?void 0:a.License,specificLicense:null===(i=e.value.metadata)||void 0===i?void 0:i.License,isOsiApproved:!0}):v.push({generalLicense:null!==(r=null===l||void 0===l?void 0:l[1])&&void 0!==r?r:null===(o=e.value.metadata)||void 0===o?void 0:o.License,specificLicense:null===(c=e.value.metadata)||void 0===c?void 0:c.License,isOsiApproved:!1}))})),0===v.length)v.push({generalLicense:null!==(o=null===e||void 0===e||null===(c=e.value)||void 0===c||null===(l=c.metadata)||void 0===l?void 0:l.License)&&void 0!==o?o:"N/A",specificLicense:null!==(s=null===e||void 0===e||null===(d=e.value)||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.License)&&void 0!==s?s:"N/A",isOsiApproved:null});v.forEach((function(t){var a,i,r;n[t.generalLicense]||(n[t.generalLicense]={packages:{},metadata:{isOsiApproved:t.isOsiApproved}}),n=Object(F.a)(Object(F.a)({},n),{},Object(de.a)({},t.generalLicense,Object(F.a)(Object(F.a)({},n[t.generalLicense]),{},{packages:Object(F.a)(Object(F.a)({},null!==(a=n[t.generalLicense].packages)&&void 0!==a?a:null),{},Object(de.a)({},e.value.id,{depth:null!==(i=null===(r=e.value)||void 0===r?void 0:r.depth)&&void 0!==i?i:0,specific:t.specificLicense}))})))}))}}))}})),r(n)}}),[e]),i};function bt(e,n,t,i){var r=function(e,n){var t=Object(a.useState)(),i=Object(m.a)(t,2),r=i[0],o=i[1];return Object(a.useEffect)((function(){var t,a,i,r;if(e&&null!==n&&void 0!==n&&n.metadata){var c={added:0,removed:0,version:0,unchanged:0,justification:{},build:""};e.nodes.forEach((function(e){switch(e.value.change){case"added":c.added++;break;case"removed":c.removed++;break;case"version":c.version++;break;default:c.unchanged++}})),c.build="We have analysed an application stack running on ".concat(n.metadata.os_release.name," ").concat(n.metadata.os_release.version,", running Python (").concat(n.metadata.python.implementation_name,") ").concat(n.metadata.python.major,".").concat(n.metadata.python.minor,".").concat(n.metadata.python.micro,". It was Adviser Job ID ").concat(n.metadata.document_id,", by ").concat(n.metadata.analyzer," v").concat(n.metadata.analyzer_version,"."),null===n||void 0===n||null===(t=n.result)||void 0===t||null===(a=t.report)||void 0===a||null===(i=a.products)||void 0===i||null===(r=i[0])||void 0===r||r.justification.forEach((function(e){c.justification[e.type]?c.justification[e.type]=c.justification[e.type]+1:c.justification[e.type]=1})),o(c)}}),[e,n]),r}(t,i),o=vt(e),c=vt(n),l=jt(e),s=jt(n);return Object(a.useMemo)((function(){var e={advise:null,oldGraph:{dependencies:null,licenses:null},newGraph:{dependencies:null,licenses:null}};return r&&(e.advise=r),o&&(e.oldGraph.dependencies=o),l&&(e.oldGraph.licenses=l),c&&(e.newGraph.dependencies=c),s&&(e.newGraph.licenses=s),e}),[r,o,l,c,s])}var ht=function(e,n,t,a,i,r){return te.a.get(ae+"/python/package/version/metadata",{params:{name:e,version:n,index:t,os_name:a,os_version:i,python_version:r},headers:{accept:"application/json"}})},pt=function(e,n){return Object(l.useQueries)(e.map((function(e){return Object(F.a)(Object(F.a)({},n),{},{enabled:!!e.name&&!!e.version&&!!e.index&&!!e.os_name&&!!e.os_version&&!!e.python_version,queryKey:["packageMetadata",e.name,e.version,e.index,e.os_name,e.os_version,e.python_version],queryFn:function(){return ht(e.name,e.version,e.index,e.os_name,e.os_version,e.python_version)}})})))};var mt=function(){function e(n,t){Object(lt.a)(this,e),this.adjacents=void 0,this.key=void 0,this.value=void 0,this.parents=void 0,this.adjacents=new Set,this.key=n,this.value=t,this.parents=new Set}return Object(st.a)(e,[{key:"addAdjacent",value:function(e){this.adjacents.add(e)}},{key:"isAdjacent",value:function(e){return this.adjacents.has(e)}},{key:"getAdjacents",value:function(){return Array.from(this.adjacents)}}]),e}();function Ot(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,t=pt(e),i=Object(a.useMemo)((function(){return t.some((function(e){return e.isLoading}))}),[t]);return Object(a.useMemo)((function(){if(!i){var e=new dt,a=[];t.forEach((function(n){if(n.error){var t,a,i,r,o,c=n.error,l=null!==(t=null===(a=c.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.parameters)&&void 0!==t?t:null===(r=c.response)||void 0===r||null===(o=r.config)||void 0===o?void 0:o.params,s={id:l.name.toLowerCase(),label:l.name+" "+l.version,name:l.name,version:l.version,metadata:null,depth:0};e.addVertex(s.id,s,mt)}else if(n.isSuccess){var d=n.data.data.metadata,u={id:d.package_name.toLowerCase(),label:d.package_name+" "+d.package_version,name:d.package_name,version:d.package_version,metadata:d.importlib_metadata.metadata};e.addVertex(u.id,u,mt)}})),t.forEach((function(n){var t;if("error"!==n.status&&null!==(t=n.data)&&void 0!==t&&t.data){var i=e.nodes.get(n.data.data.metadata.package_name.toLowerCase());i&&Object.keys(n.data.data.metadata.dependencies).forEach((function(n){var t=e.nodes.get(n);t&&(e.addEdge(i.value.id,t.value.id),t.parents.add(i.value.id),a.push(t.value.id))}))}}));var r=e.addVertex("*App",{id:"*App",label:"App",depth:-1},mt);a.push("*App");var o=new Set,c=[];for(e.nodes.forEach((function(t,i){a.includes(i)&&!Object.keys(null!==n&&void 0!==n?n:{}).includes(i)||(t.value.depth=0,t.parents.add("*App"),c.push(t),e.addEdge(r.key,t.key))}));0!==c.length;){var l=c.pop();if(l&&!o.has(l)){o.add(l);for(var s=l.getAdjacents(),d=0;d<s.length;d++){var u,v,j,b,h;s[d].value.depth=Math.min((null!==(u=null===(v=l.value)||void 0===v?void 0:v.depth)&&void 0!==u?u:0)+1,null!==(j=s[d].value.depth)&&void 0!==j?j:(null!==(b=null===(h=l.value)||void 0===h?void 0:h.depth)&&void 0!==b?b:0)+2),c.push(s[d])}}}return e}}),[i,n])}var xt=function(e){var n=e.analysis_id;return Object(b.jsxs)("div",{children:['`"',n,'"` not found']})},ft=function(e){var n=e.children,t=e.goHome,a=void 0!==t&&t,i=Object(A.g)();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(d.a,{onClick:function(){i(a?"/":-1)},children:a?"go home":"go back"}),Object(b.jsx)("div",{children:n})]})},gt=function(){var e,n,t,i,r,o,c,s,d,u,v,j,h,p,O,x,f,g,y=Object(A.h)().analysis_id,k=it(y,{useErrorBoundary:!1,refetchInterval:function(e){var n;return!(null===e||void 0===e||null===(n=e.data)||void 0===n||!n.status)&&1e4}}),_=function(e,n){return Object(l.useQuery)(Object(F.a)(Object(F.a)({},n),{},{queryKey:["adviseLogs",e],queryFn:function(){return rt(e)}}))}(y,{useErrorBoundary:!1,refetchInterval:function(){var e,n;return!(null===(e=k.data)||void 0===e||null===(n=e.data)||void 0===n||!n.status)&&1e4}}),w=Object(a.useMemo)((function(){var e,n,t,a;if(k.isSuccess&&null!==(e=k.data.data)&&void 0!==e&&null!==(n=e.result)&&void 0!==n&&null!==(t=n.parameters)&&void 0!==t&&t.project)return ot(null===(a=k.data.data)||void 0===a?void 0:a.result.parameters.project)}),[k]),S=Object(a.useMemo)((function(){var e,n,t,a,i,r,o,c,l,s;if(k.isSuccess&&null!==(e=k.data.data)&&void 0!==e&&null!==(n=e.result)&&void 0!==n&&null!==(t=n.report)&&void 0!==t&&null!==(a=t.products)&&void 0!==a&&null!==(i=a[0])&&void 0!==i&&i.project)return ot(null===(r=k.data.data)||void 0===r||null===(o=r.result)||void 0===o||null===(c=o.report)||void 0===c||null===(l=c.products)||void 0===l||null===(s=l[0])||void 0===s?void 0:s.project)}),[k]),C=Ot(w,null===k||void 0===k||null===(e=k.data)||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.result)||void 0===t||null===(i=t.parameters)||void 0===i||null===(r=i.project)||void 0===r||null===(o=r.requirements)||void 0===o?void 0:o.packages),E=Ot(S,null===k||void 0===k||null===(c=k.data)||void 0===c||null===(s=c.data)||void 0===s||null===(d=s.result)||void 0===d||null===(u=d.report)||void 0===u||null===(v=u.products)||void 0===v||null===(j=v[0])||void 0===j||null===(h=j.project)||void 0===h||null===(p=h.requirements)||void 0===p?void 0:p.packages),P=function(e,n,t){var i=Object(a.useState)(),r=Object(m.a)(i,2),o=r[0],c=r[1],l=Object(B.a)();return Object(a.useEffect)((function(){var a,i,r,o;if(e&&n){var s=new dt;n.nodes.forEach((function(t,a){var i=n.nodes.get(a);if(i){var r,o,c,d,u;if(e.nodes.has(a))if(i.value=Object(F.a)(Object(F.a)({},i.value),{},{dependencies:t.adjacents.size,lockfile:["new","old"]}),(null===t||void 0===t||null===(r=t.value)||void 0===r||null===(o=r.metadata)||void 0===o?void 0:o.Version)===(null===(c=e.nodes.get(a))||void 0===c||null===(d=c.value)||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.Version))i.value=Object(F.a)(Object(F.a)({},i.value),{},{change:"unchanged"});else{var v,j,b,h,p,m,O,x,f;i.value=Object(F.a)(Object(F.a)({},i.value),{},{change:"version",oldVersion:null!==(v=null===(j=e.nodes.get(a))||void 0===j||null===(b=j.value)||void 0===b||null===(h=b.metadata)||void 0===h?void 0:h.Version)&&void 0!==v?v:null===(p=e.nodes.get(a))||void 0===p||null===(m=p.value)||void 0===m?void 0:m.version,font:{color:l.palette.success.main}}),i.parents=new Set([].concat(Object(Mn.a)(i.parents),Object(Mn.a)(null!==(O=null===(x=e.nodes.get(a))||void 0===x?void 0:x.parents)&&void 0!==O?O:[])));var g=new Map;i.adjacents.forEach((function(e){g.set(e.key,e)})),null===(f=e.nodes.get(a))||void 0===f||f.adjacents.forEach((function(e){g.has(e.key)||g.set(e.key,e)})),i.adjacents=new Set(g.values())}else i.value=Object(F.a)(Object(F.a)({},i.value),{},{change:"added",font:{color:l.palette.success.main},color:l.palette.success.main,dependencies:t.adjacents.size,lockfile:["new"]});s.nodes.set(a,i)}})),e.nodes.forEach((function(t,a){var i,r,o,c,d,u,v,j,b,h,p,m=e.nodes.get(a);m&&(n.nodes.has(a)||(m.value=Object(F.a)(Object(F.a)({},m.value),{},{change:"removed",label:t.value.label+" "+(null!==(i=null===t||void 0===t||null===(r=t.value)||void 0===r||null===(o=r.metadata)||void 0===o?void 0:o.Version)&&void 0!==i?i:null===t||void 0===t||null===(c=t.value)||void 0===c?void 0:c.version),font:{color:l.palette.error.main},color:l.palette.error.main,version:null!==(d=null===t||void 0===t||null===(u=t.value)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.Version)&&void 0!==d?d:null===t||void 0===t||null===(j=t.value)||void 0===j?void 0:j.version,dependencies:t.adjacents.size,license:null!==(b=null===t||void 0===t||null===(h=t.value)||void 0===h||null===(p=h.metadata)||void 0===p?void 0:p.License)&&void 0!==b?b:"",lockfile:["old"]}),s.nodes.set(a,m)))}));var d=new Map;e.nodes.forEach((function(e){e.adjacents.forEach((function(n){d.set(e.value.id+n.value.id,{id:e.value.id+n.value.id,to:e.value.id,from:n.value.id})}))})),n.nodes.forEach((function(e){e.adjacents.forEach((function(n){d.set(e.value.id+n.value.id,{id:e.value.id+n.value.id,to:e.value.id,from:n.value.id})}))})),ut(Array.from(s.nodes.values()),null===t||void 0===t||null===(a=t.result)||void 0===a||null===(i=a.report)||void 0===i||null===(r=i.products)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.justification),s.visEdges=Array.from(d.values()),c(s)}}),[e,n,t,l]),o}(C,E,null===(O=k.data)||void 0===O?void 0:O.data),M=bt(C,E,P,null===(x=k.data)||void 0===x?void 0:x.data);return k.isLoading?Object(b.jsx)("div",{className:"w-full h-48 flex justify-center items-center",children:Object(b.jsx)(Ie.a,{})}):k.data?Object(b.jsx)(ft,{goHome:!0,children:Object(b.jsx)(L,{header:Object(b.jsx)(cn,{adviseDocument:k.data.data,logs:null===(f=_.data)||void 0===f||null===(g=f.data)||void 0===g?void 0:g.log}),children:Object(b.jsxs)(A.d,{children:[Object(b.jsx)(A.b,{path:"summary",element:Object(b.jsx)(at,{metrics:M})}),Object(b.jsx)(A.b,{path:"details",element:Object(b.jsx)(yn,{mergedGraph:P})}),Object(b.jsx)(A.b,{path:"*",element:Object(b.jsx)(A.a,{to:"summary"})})]})})}):Object(b.jsx)(ft,{children:Object(b.jsx)(xt,{analysis_id:null!==y&&void 0!==y?y:"no id"})})},yt=t(212),kt=t.n(yt),_t=t(213),wt=t.n(_t),St=t(302),Ct=t(51),Et=["options","type","label","disabled"],At=function(e){var n,t=e.options,i=e.type,r=e.label,o=e.disabled,c=Object(z.a)(e,Et),l=Object(A.g)(),s=Object(a.useContext)(Ft),d=s.specs,u=s.defaultSpecs;return Object(b.jsxs)(k.a,Object(F.a)(Object(F.a)({},c),{},{children:[Object(b.jsx)(V.a,{variant:"body2",children:r}),Object(b.jsxs)(St.a,{displayEmpty:!0,fullWidth:!0,value:null!==(n=d[i])&&void 0!==n?n:"",onChange:function(e){var n,t,a,r,o,c,s,v,j,b,h,p,m;switch(i){case"package_version":l("/package/".concat(d.package_name,"/").concat(e.target.value));break;case"index_url":l("/package/".concat(d.package_name,"/").concat(null!==(n=d.package_version)&&void 0!==n?n:u.package_version,"/").concat(encodeURIComponent(e.target.value)));break;case"os_name":l("/package/".concat(d.package_name,"/").concat(null!==(t=d.package_version)&&void 0!==t?t:u.package_version,"/").concat(encodeURIComponent(null!==(a=null!==(r=d.index_url)&&void 0!==r?r:u.index_url)&&void 0!==a?a:""),"/").concat(e.target.value));break;case"os_version":l("/package/".concat(d.package_name,"/").concat(null!==(o=d.package_version)&&void 0!==o?o:u.package_version,"/").concat(encodeURIComponent(null!==(c=null!==(s=d.index_url)&&void 0!==s?s:u.index_url)&&void 0!==c?c:""),"/").concat(null!==(v=d.os_name)&&void 0!==v?v:u.os_name,"/").concat(e.target.value));break;case"python_version":l("/package/".concat(d.package_name,"/").concat(null!==(j=d.package_version)&&void 0!==j?j:u.package_version,"/").concat(encodeURIComponent(null!==(b=null!==(h=d.index_url)&&void 0!==h?h:u.index_url)&&void 0!==b?b:""),"/").concat(null!==(p=d.os_name)&&void 0!==p?p:u.os_name,"/").concat(null!==(m=d.os_version)&&void 0!==m?m:u.os_version,"/").concat(e.target.value))}},size:"small",variant:"outlined",disabled:o,renderValue:function(e){return e||Object(b.jsx)("em",{style:{color:"grey"},children:null!==(n=null===u||void 0===u?void 0:u[i])&&void 0!==n?n:r});var n},children:[Object(b.jsx)(Ct.a,{disabled:!0,value:"",children:Object(b.jsx)("em",{children:r})}),t.map((function(e){return Object(b.jsx)(Ct.a,{value:e.value,children:e.value},e.value)}))]})]}))},Pt=function(e){var n,t,r=e.metadata,o=e.allVersions,c=void 0===o?[]:o,l=e.allEnvironments,s=void 0===l?[]:l,d=Object(a.useContext)(Ft),u=d.defaultSpecs,v=d.specs,j=Object(a.useState)(!1),h=Object(m.a)(j,2),p=h[0],O=h[1],x=Object(a.useMemo)((function(){var e=new Set;return c.filter((function(n){return!e.has(n.package_version)&&(e.add(n.package_version),!0)})).map((function(e){return{value:e.package_version}})).sort((function(e,n){return e.value.split(".")>n.value.split(".")?1:-1}))}),[c]),f=Object(a.useMemo)((function(){var e=new Set;return c.filter((function(e){return v.package_version?v.package_version===e.package_version:u.package_version===e.package_version})).filter((function(n){return!e.has(n.index_url)&&(e.add(n.index_url),!0)})).map((function(e){return{value:e.index_url}}))}),[c]),g=Object(a.useMemo)((function(){return[s.map((function(e){return{value:e.os_name}})),s.filter((function(e){return!v.os_name||v.os_name===e.os_name})).map((function(e){return{value:e.os_version}})),s.filter((function(e){return(!v.os_name||v.os_name===e.os_name)&&(!v.os_version||v.os_version===e.os_version)})).map((function(e){return{value:e.python_version}}))]}),[s,v]),y=Object(m.a)(g,3),_=y[0],w=y[1],S=y[2];return r?Object(b.jsxs)("div",{children:[Object(b.jsxs)(N.a,{container:!0,alignItems:"flex-end",spacing:1,children:[Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(V.a,{variant:"h4",mr:2,children:Object(b.jsx)("b",{children:null===r||void 0===r?void 0:r.Name})})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(At,{options:null!==x&&void 0!==x?x:[],type:"package_version",label:"Version"})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(At,{options:null!==f&&void 0!==f?f:[],type:"index_url",label:"Index URL",disabled:void 0===v.package_version})}),p?Object(b.jsxs)(i.a.Fragment,{children:[Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(At,{options:null!==_&&void 0!==_?_:[],type:"os_name",label:"OS Name",disabled:void 0===v.index_url})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(At,{options:null!==w&&void 0!==w?w:[],type:"os_version",label:"OS Version",disabled:void 0===v.os_name})}),Object(b.jsx)(N.a,{item:!0,children:Object(b.jsx)(At,{options:null!==S&&void 0!==S?S:[],type:"python_version",label:"Python Version",disabled:void 0===v.os_version})})]}):null,Object(b.jsx)(N.a,{item:!0,xs:1,children:Object(b.jsx)(Me.a,{onClick:function(){return O(!p)},"data-testid":"package-header-expand-button",children:p?Object(b.jsx)(kt.a,{fontSize:"large"}):Object(b.jsx)(wt.a,{fontSize:"large"})})})]}),Object(b.jsx)(V.a,{gutterBottom:!0,variant:"body1",mt:2,children:null!==(n=null===r||void 0===r?void 0:r.Summary)&&void 0!==n?n:"NaN"}),Object(b.jsx)("div",{children:Object(b.jsx)(nn,{text:null!==(t=null===r||void 0===r?void 0:r.License)&&void 0!==t?t:"NaN",icon:Object(b.jsx)(wn.a,{})})})]}):Object(b.jsxs)(k.a,{"data-testid":"package-header-not-loaded",children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Lt=t(217),Mt=t(214),It=t.n(Mt),Nt=function(e){var n,t=e.node,r=i.a.useState(null),o=Object(m.a)(r,2),c=o[0],l=o[1],s=i.a.useState(null),u=Object(m.a)(s,2),v=u[0],j=u[1],h=Object(A.g)(),p=Object(a.useMemo)((function(){var e={},n=[0,0],a=new Set;if(t.versions.forEach((function(t){var i,r=t.split("."),o=r[0]+"."+(null!==(i=r[1])&&void 0!==i?i:"");void 0===e[o]&&(e[o]=[],n[0]+=1),a.has(t)||(e[o].push(t),n[1]+=1,a.add(t))})),n[0]/n[1]>.25){var i,r=Math.ceil(.25*n[0]),o={};return Object.keys(e).forEach((function(n,t,a){var c,l;t%r===0&&(i="".concat(n," - ").concat(null!==(l=a[t+r-1])&&void 0!==l?l:a.at(-1)),o[i]=[]);(c=o[i]).push.apply(c,Object(Mn.a)(e[a[t]]))})),o}return e}),[t]);return Object(b.jsxs)("div",{children:[Object(b.jsx)(d.a,{onClick:function(e){l(t.name),j(e.currentTarget)},variant:"outlined",endIcon:Object(b.jsx)(It.a,{}),children:null!==(n=t.specifier)&&void 0!==n?n:"ANY"}),Object(b.jsxs)(Lt.a,{open:c===t.name,anchorEl:v,onClose:function(){l(void 0),j(null)},PaperProps:{style:{maxHeight:"40%",maxWidth:"50%"}},children:[Object(b.jsx)(Ct.a,{disabled:!0,children:"Select a version to navigate to:"}),Object(b.jsx)(N.a,{container:!0,alignContent:"flex-start",children:Object.entries(p).map((function(e){var n=Object(m.a)(e,2),a=n[0],i=n[1];return Object(b.jsxs)(N.a,{item:!0,xs:!0,children:[Object(b.jsx)(Ct.a,{sx:{mt:2},disabled:!0,divider:!0,children:a}),i.map((function(e){return Object(b.jsx)(Ct.a,{onClick:function(){return h("/package/".concat(t.name,"/").concat(e))},children:Object(b.jsx)(V.a,{variant:"body2",children:e})},e)}))]},a)}))})]})]})},Vt=function(e){var n=e.graph,t=Object(a.useMemo)((function(){if(null!==n&&void 0!==n&&n.nodes){var e=n.nodes.get("*App");if(e){var t=n.graphSearch(e),a=Array.from(t),i=[];return a.forEach((function(e){var n,t,a,r;"*App"===e.key||e.value.metadata||i.push({name:null!==(n=e.value.label)&&void 0!==n?n:e.key,versions:null!==(t=e.value.versions)&&void 0!==t?t:[],specifier:null!==(a=e.value.specifier)&&void 0!==a?a:"*",extra:null!==(r=e.value.extra)&&void 0!==r?r:[]})})),i}}}),[n]);return t?Object(b.jsx)(Ue,{cardMeta:{title:"Dependencies"},cardBody:Object(b.jsxs)("div",{"data-testid":"package-dependencies-loaded",children:[Object(b.jsxs)(N.a,{container:!0,children:[Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"Package"})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"Versions"})}),Object(b.jsx)(N.a,{item:!0,xs:2,children:Object(b.jsx)(V.a,{variant:"h6",gutterBottom:!0,children:"Extra"})})]}),Object(b.jsx)(T.a,{}),Object(b.jsx)(N.a,{container:!0,rowSpacing:2,mt:1,children:t.map((function(e){var n;return Object(b.jsxs)(N.a,{container:!0,item:!0,xs:12,children:[Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(V.a,{variant:"body1",gutterBottom:!0,children:e.name})}),Object(b.jsx)(N.a,{item:!0,xs:!0,children:Object(b.jsx)(Nt,{node:e})}),Object(b.jsx)(N.a,{item:!0,xs:2,children:Object(b.jsx)(V.a,{variant:"body1",gutterBottom:!0,children:null===(n=e.extra)||void 0===n?void 0:n.join(", ")})})]},e.name)}))})]})}):Object(b.jsxs)(k.a,{"data-testid":"package-dependencies-not-loaded",children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Dt=function(e){var n=e.package_name,t=e.package_version;return Object(b.jsxs)("div",{children:['`"',n,t?" "+t:"",'"` not found']})},Rt=function(){var e=Object(K.a)(Q.a.mark((function e(n){var t,a,i=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:0,a=i.length>2&&void 0!==i[2]?i[2]:100,e.abrupt("return",te.a.get(ae+"/python/package/versions",{params:{name:n,page:t,per_page:a},headers:{accept:"application/json"}}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Tt=function(){var e=Object(K.a)(Q.a.mark((function e(n,t,a){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.get(ae+"/python/package/version/environments",{params:{name:n,version:t,index:a},headers:{accept:"application/json"}}));case 1:case"end":return e.stop()}}),e)})));return function(n,t,a){return e.apply(this,arguments)}}(),Bt=function(e){var n,t,i=(n=e,Object(l.useInfiniteQuery)(Object(F.a)(Object(F.a)({},t),{},{enabled:!!n,queryKey:["packageVersions",n],queryFn:function(e){return Rt(n,e.pageParam)},getNextPageParam:function(e){var n,t=e.data.parameters;return 0===e.data.versions.length?void 0:(null!==(n=t.page)&&void 0!==n?n:0)+1}}))),r=Object(a.useState)([]),o=Object(m.a)(r,2),c=o[0],s=o[1];return Object(a.useEffect)((function(){if(i.isSuccess)if(i.hasNextPage&&!i.isFetchingNextPage)i.fetchNextPage().then();else if(!i.hasNextPage&&!i.isFetchingNextPage){var e=[];i.data.pages.forEach((function(n){e=[].concat(Object(Mn.a)(e),Object(Mn.a)(n.data.versions))})),e.length>0?(e=e.reverse(),s(e)):s(void 0)}}),[i.data]),c};var qt=function(e){var n=e.message,t=e.type,a=e.reason;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{children:[t,": ",n]}),Object(b.jsx)("p",{children:a})]})},Ft=i.a.createContext({specs:{package_name:""},defaultSpecs:{package_name:""}}),zt=function(){var e,n,t,i,r,o,c,s,d,u,v,j,h,p,O=Object(A.h)(),x=Object(a.useState)({package_name:null!==(e=O.package_name)&&void 0!==e?e:"",package_version:void 0,index_url:void 0,os_name:void 0,os_version:void 0,python_version:void 0}),f=Object(m.a)(x,2),g=f[0],y=f[1],k=Object(a.useMemo)((function(){var e;return{package_name:null!==(e=O.package_name)&&void 0!==e?e:"",package_version:null===O||void 0===O?void 0:O.package_version,index_url:null!==O&&void 0!==O&&O.index_url?decodeURIComponent(O.index_url):void 0,os_name:null===O||void 0===O?void 0:O.os_name,os_version:null===O||void 0===O?void 0:O.os_version,python_version:null===O||void 0===O?void 0:O.python_version}}),[O]),_=Bt(k.package_name),w=(v=k.package_name,j=null!==(n=k.package_version)&&void 0!==n?n:g.package_version,h=null!==(t=k.index_url)&&void 0!==t?t:g.index_url,p={useErrorBoundary:!1},Object(l.useQuery)(Object(F.a)(Object(F.a)({},p),{},{enabled:!!v&&!!j&&!!h,queryKey:["packageEnvironments",v,j,h],queryFn:function(){return Tt(v,j,h)}})));Object(a.useEffect)((function(){var e,n,t,a={package_name:null!==(e=O.package_name)&&void 0!==e?e:"",package_version:void 0,index_url:void 0,os_name:void 0,os_version:void 0,python_version:void 0};k.package_name&&(_&&_.length>0&&(a.package_version=null===(n=_.at(0))||void 0===n?void 0:n.package_version,a.index_url=null===(t=_.at(0))||void 0===t?void 0:t.index_url));if(w.data&&w.data.data.environments.length>0){var i,r,o,c=w.data.data.environments.filter((function(e){return(!k.os_name||k.os_name===e.os_name)&&(!k.os_version||k.os_version===e.os_version)}));if(c.length>0)a.os_name=null===(i=c.at(0))||void 0===i?void 0:i.os_name,a.os_version=null===(r=c.at(0))||void 0===r?void 0:r.os_version,a.python_version=null===(o=c.at(0))||void 0===o?void 0:o.python_version}Object.entries(g).some((function(e){var n=Object(m.a)(e,2),t=n[0],i=n[1];return a[t]!==i}))&&y(a)}),[_,w,k]);var S,C,E,P,L,M,I,V,D,R=function(e,n,t,a,i,r,o){return Object(l.useQuery)(Object(F.a)(Object(F.a)({},o),{},{enabled:!!e&&!!n&&!!t&&!!a&&!!i&&!!r,queryKey:["packageMetadata",e,n,t,a,i,r],queryFn:function(){return ht(e,n,t,a,i,r)}}))}(k.package_name,null!==(i=k.package_version)&&void 0!==i?i:g.package_version,null!==(r=k.index_url)&&void 0!==r?r:g.index_url,null!==(o=k.os_name)&&void 0!==o?o:g.os_name,null!==(c=k.os_version)&&void 0!==c?c:g.os_version,null!==(s=k.python_version)&&void 0!==s?s:g.python_version,{useErrorBoundary:!1}),T=function(e){var n=Object(a.useState)(),t=Object(m.a)(n,2),i=t[0],r=t[1];return Object(a.useEffect)((function(){if("success"===e.status){var n=new dt,t=n.addVertex("*App",{id:"*App",label:"App",depth:-1},mt),a=n.addVertex(e.data.data.metadata.package_name.toLowerCase(),{id:e.data.data.metadata.package_name.toLowerCase(),label:e.data.data.metadata.package_name,metadata:e.data.data.metadata.importlib_metadata.metadata,depth:0},mt);a.parents=new Set,a.parents.add("*App"),n.addEdge(t.key,a.key),Object.entries(e.data.data.metadata.dependencies).forEach((function(e){var t=Object(m.a)(e,2),i=t[0],r=t[1],o=n.addVertex(i.toLowerCase(),{id:i.toLowerCase(),label:i,metadata:null,versions:r.versions,specifier:r.specifier,extra:r.extra,depth:1},mt);o.parents=new Set,n.addEdge(a.key,o.key),o.parents.add(a.key)})),r(n)}}),[e.data]),i}(R);return R.isLoading||0===(null===_||void 0===_?void 0:_.length)?Object(b.jsx)("div",{className:"w-full h-48 flex justify-center items-center","data-testid":"loading",children:Object(b.jsx)(Ie.a,{})}):R.data?Object(b.jsx)(Ft.Provider,{value:{specs:k,defaultSpecs:g},children:Object(b.jsxs)(N.a,{container:!0,children:[Object(b.jsx)(N.a,{item:!0,xs:12,mb:3,children:Object(b.jsx)(Pt,{metadata:R.data.data.metadata.importlib_metadata.metadata,allVersions:_,allEnvironments:null===w||void 0===w||null===(d=w.data)||void 0===d||null===(u=d.data)||void 0===u?void 0:u.environments})}),Object(b.jsx)(N.a,{item:!0,xs:12,md:6,children:Object(b.jsx)(Vt,{graph:T})})]})}):null!==R&&void 0!==R&&null!==(S=R.error)&&void 0!==S&&null!==(C=S.response)&&void 0!==C&&null!==(E=C.data)&&void 0!==E&&E.error?Object(b.jsx)(qt,{message:R.error.response.data.error,type:R.error.response.status,reason:"".concat(null===R||void 0===R||null===(M=R.error)||void 0===M||null===(I=M.config)||void 0===I?void 0:I.url," failed with params ").concat(JSON.stringify(null===R||void 0===R||null===(V=R.error)||void 0===V||null===(D=V.config)||void 0===D?void 0:D.params))}):Object(b.jsx)(Dt,{package_name:null!==(P=O.package_name)&&void 0!==P?P:"",package_version:null!==(L=O.package_version)&&void 0!==L?L:""})},Wt=function(){return Object(b.jsx)(ft,{children:Object(b.jsxs)(A.d,{children:[Object(b.jsx)(A.b,{path:"/:package_version/:index_url/:os_name/:os_version/:python_version",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"/:package_version/:index_url/:os_name",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"/:package_version/:index_url/:os_name/:os_version",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"/:package_version/:index_url",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"/:package_version",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"/",element:Object(b.jsx)(zt,{})}),Object(b.jsx)(A.b,{path:"*",element:Object(b.jsx)(Ne,{})})]})})},Ht=function(e){var n,t,r,o,c,l,s=e.imageDocument,u=e.logs,v=i.a.useState(!1),j=Object(m.a)(v,2),h=j[0],p=j[1],O=i.a.useState(),x=Object(m.a)(O,2),f=x[0],g=x[1],y=Object(a.useMemo)((function(){var e;return null!==s&&void 0!==s&&s.result?["COMPLETE","success"]:null!==s&&void 0!==s&&null!==(e=s.status)&&void 0!==e&&e.state?[s.status.state.toUpperCase(),"info"]:["UNKNOWN",void 0]}),[s]),k=Object(m.a)(y,2),_=k[0],S=k[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)(V.a,{variant:"h4",mb:2,children:Object(b.jsx)("b",{children:null!==(n=null===s||void 0===s||null===(t=s.metadata)||void 0===t?void 0:t.document_id)&&void 0!==n?n:s.parameters.analysis_id})}),Object(b.jsxs)(w.a,{direction:"row",spacing:2,children:[Object(b.jsx)(Qe.a,{label:_,color:S}),Object(b.jsx)(nn,{text:on(null===s||void 0===s||null===(r=s.status)||void 0===r?void 0:r.finished_at,null===s||void 0===s||null===(o=s.status)||void 0===o?void 0:o.started_at,null===s||void 0===s||null===(c=s.metadata)||void 0===c?void 0:c.datetime),icon:Object(b.jsx)(Ye.a,{})}),Object(b.jsx)(d.a,{sx:{marginLeft:2},onClick:function(){return p(!h)},children:Object(b.jsx)(nn,{text:"Logs",icon:Object(b.jsx)(Xe.a,{})})})]}),Object(b.jsx)(ue.a,{in:h,children:null!==(l=null===u||void 0===u?void 0:u.split("\n").map((function(e,n){return Object(b.jsx)(V.a,{noWrap:f!==n,onClick:function(){return g(f===n?void 0:n)},variant:"body2",sx:{backgroundColor:f===n?"lightyellow":n%2===0?"lightgray":"unset"},children:e},n)})))&&void 0!==l?l:"Image log is not available."})]})},Gt=t(138),Kt=[{field:"name",headerName:"Package Name",flex:1},{field:"version",headerName:"Version",flex:.5},{field:"arch",headerName:"Architecture",flex:.5}],Ut=function(e){var n,t=e.imageDocument;return t?Object(b.jsx)("div",{style:{height:400,width:"100%"},children:Object(b.jsx)(Gt.a,{disableSelectionOnClick:!0,disableColumnSelector:!0,hideFooterSelectedRowCount:!0,getRowId:function(e){return e.package_identifier},density:"compact",rows:null===t||void 0===t||null===(n=t.result)||void 0===n?void 0:n.deb,columns:Kt,pageSize:50,rowsPerPageOptions:[25,50,100]})}):Object(b.jsxs)(k.a,{children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Qt=function(e){var n=e.imageDocument;if(!n)return Object(b.jsxs)(k.a,{"data-testid":"python-info-not-loaded",children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]});var t=Object(a.useMemo)((function(){var e;if(null===n||void 0===n||null===(e=n.result)||void 0===e||!e["python-files"])return[];var t=new Map;return n.result["python-files"].forEach((function(e){var n=e.filepath.split("/",4),a=n[1]+"/"+n[2]+"/"+n[3];t.has(a)?t.set(a,t.get(a)+1):t.set(a,1)})),Array.from(t.entries()).map((function(e){var n=Object(m.a)(e,2);return{path:n[0],count:n[1]}}))}),[n]),i=Object(a.useMemo)((function(){return n.result["python-interpreters"].filter((function(e){return!!e.version}))}),[n]);return Object(b.jsxs)(w.a,{direction:"column",spacing:3,children:[(null===i||void 0===i?void 0:i.length)>0?Object(b.jsxs)(w.a,{direction:"row",spacing:1,alignItems:"center",children:[Object(b.jsxs)(V.a,{variant:"h6",children:["Python interpreters:"," "]}),i.map((function(e,n){var t;return Object(b.jsx)(Qe.a,{"data-testid":"python-info-chip",label:e.version},(null!==(t=null===e||void 0===e?void 0:e.version)&&void 0!==t?t:"")+n)}))]}):void 0,Object(b.jsxs)("div",{"data-testid":"python-info-loaded",children:[Object(b.jsxs)(w.a,{direction:"row",spacing:1,mb:1,alignItems:"center",children:[Object(b.jsxs)(V.a,{variant:"h6",children:["Total number of Python files:"," "]}),Object(b.jsx)(V.a,{variant:"body1",children:t.reduce((function(e,n){return e+n.count}),0)})]}),Object(b.jsx)(N.a,{container:!0,children:t.sort((function(e,n){return n.count-e.count})).map((function(e){return Object(b.jsx)(N.a,{item:!0,xs:12,lg:6,xl:4,children:Object(b.jsxs)(w.a,{ml:3,direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[Object(b.jsxs)(V.a,{variant:"body2",children:[e.path,":"]}),Object(b.jsx)(V.a,{variant:"body2",children:Object(b.jsx)("b",{children:e.count})})]})},e.path)}))})]})]})},Jt=function(e){var n,t,i,r,o,c,l,s,d,u,v,j=e.imageDocument,h=e.imageMetadata,p=Object(a.useMemo)((function(){var e;return h||(null!==j&&void 0!==j&&null!==(e=j.result)&&void 0!==e&&e["skopeo-inspect"]?{architecture:j.result["skopeo-inspect"].Architecture,created:j.result["skopeo-inspect"].Created,digest:j.result["skopeo-inspect"].Digest,docker_version:j.result["skopeo-inspect"].DockerVersion,labels:j.result["skopeo-inspect"].Labels,layers:j.result["skopeo-inspect"].Layers,os:j.result["skopeo-inspect"].Os,repo_tags:j.result["skopeo-inspect"].RepoTags}:void 0)}),[j,h]);return p?Object(b.jsxs)(N.a,{container:!0,spacing:2,children:[Object(b.jsx)(N.a,{item:!0,xs:12,children:Object(b.jsxs)(w.a,{direction:"row",spacing:2,alignItems:"center",children:[Object(b.jsx)(V.a,{variant:"body1",children:Object(b.jsx)("b",{children:null===(n=p.labels)||void 0===n?void 0:n["io.k8s.display-name"]})}),Object(b.jsx)(Qe.a,{label:null===(t=p.labels)||void 0===t?void 0:t.name.split(":").at(-1)})]})}),Object(b.jsx)(N.a,{item:!0,xs:12,children:Object(b.jsx)(V.a,{variant:"h6",mb:1,children:"General information"})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Summary"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(i=p.labels)||void 0===i?void 0:i.summary})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Description"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(r=p.labels)||void 0===r?void 0:r.description})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Provider"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(o=p.labels)||void 0===o?void 0:o.vendor})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Maintainer"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(c=p.labels)||void 0===c?void 0:c.maintainer})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Build date"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:new Date(null===(l=p.labels)||void 0===l?void 0:l["build-date"]).toLocaleDateString()})}),Object(b.jsx)(N.a,{item:!0,xs:12,children:Object(b.jsx)(V.a,{variant:"h6",mb:1,children:"Technical information"})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Image name"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(s=p.labels)||void 0===s?void 0:s.name})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Image version"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(d=p.labels)||void 0===d?void 0:d.version})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Architecture"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:p.architecture})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Usage"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:Object(b.jsx)("code",{children:null===(u=p.labels)||void 0===u?void 0:u.usage})})}),Object(b.jsx)(N.a,{item:!0,xs:3,children:Object(b.jsx)(V.a,{variant:"body2",mr:3,ml:2,mb:1,children:"Exposed Ports"})}),Object(b.jsx)(N.a,{item:!0,xs:9,children:Object(b.jsx)(V.a,{variant:"body2",children:null===(v=p.labels)||void 0===v?void 0:v["io.openshift.expose-services"]})})]}):Object(b.jsxs)(k.a,{"data-testid":"image-info-not-loaded",children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Yt=[{field:"name",headerName:"Package Name",flex:1},{field:"version",headerName:"Version",flex:.5},{field:"release",headerName:"Release",flex:.25},{field:"dependencies",headerName:"Dependencies",flex:.5,valueGetter:function(e){var n,t,a;return null!==(n=null===(t=e.row)||void 0===t||null===(a=t.dependencies)||void 0===a?void 0:a.length)&&void 0!==n?n:0},sortable:!1},{field:"epoch",headerName:"Epoch",flex:.5},{field:"arch",headerName:"Architecture",flex:.5}],Zt=function(e){var n,t=e.imageDocument;return t?Object(b.jsx)("div",{style:{height:400,width:"100%"},"data-testid":"rpm-info-loaded",children:Object(b.jsx)(Gt.a,{disableSelectionOnClick:!0,disableColumnSelector:!0,hideFooterSelectedRowCount:!0,getRowId:function(e){return e.package_identifier},density:"compact",rows:null===t||void 0===t||null===(n=t.result)||void 0===n?void 0:n["rpm-dependencies"],columns:Yt,pageSize:50,rowsPerPageOptions:[25,50,100]})}):Object(b.jsxs)(k.a,{"data-testid":"rpm-info-not-loaded",children:[Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{}),Object(b.jsx)(Rn.a,{width:"60%"})]})},Xt=function(e){var n,t,a,i,r,o,c,l,s,d=e.metrics,u=e.imageDocument,v=e.imageMetadata;return Object(b.jsxs)(tt.a,{columns:{xs:1,md:2},spacing:3,sx:{mb:3,mt:1},children:[u||v?Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Image Details"},cardBody:Object(b.jsx)(Jt,{imageDocument:u,imageMetadata:v})})}):void 0,(null===u||void 0===u||null===(n=u.result)||void 0===n||null===(t=n["python-interpreters"])||void 0===t?void 0:t.length)>0?Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Python Details"},cardBody:Object(b.jsx)(Qt,{imageDocument:u})})}):void 0,(null===u||void 0===u||null===(a=u.result)||void 0===a||null===(i=a["rpm-dependencies"])||void 0===i?void 0:i.length)>0?Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"RPM Details"},cardBody:Object(b.jsx)(Zt,{imageDocument:u})})}):void 0,(null===(r=u.result)||void 0===r||null===(o=r.deb)||void 0===o?void 0:o.length)>0?Object(b.jsxs)("div",{children:[Object(b.jsx)(Ue,{cardMeta:{title:"Debian Details"},cardBody:Object(b.jsx)(Ut,{imageDocument:u})})," "]}):void 0,0!==Object.keys(null!==(c=null===d||void 0===d||null===(l=d.dependencies)||void 0===l?void 0:l.all)&&void 0!==c?c:{}).length?Object(b.jsx)("div",{children:Object(b.jsx)(Ue,{cardMeta:{title:"Python Packages Dependencies"},cardBody:Object(b.jsx)(Hn,{metric:null===d||void 0===d?void 0:d.dependencies})})}):void 0,0!==Object.keys(null!==(s=null===d||void 0===d?void 0:d.licenses)&&void 0!==s?s:{}).length?Object(b.jsxs)("div",{children:[Object(b.jsx)(Ue,{cardMeta:{title:"Python Packages Licenses"},cardBody:Object(b.jsx)(et,{metric:null===d||void 0===d?void 0:d.licenses})})," "]}):void 0]})},$t=function(){var e=Object(K.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.get(ae+"/analyze/"+n,{headers:{accept:"application/json"}}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ea=function(){var e=Object(K.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.get(ae+"/analyze/"+n+"/log",{headers:{accept:"application/json"}}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),na=function(){var e=Object(K.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.a.post(ae+"/image/metadata",{},{params:{image:n},headers:{accept:"application/json","Content-Type":"application/json"}}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ta=function(e){var n=e.analysis_id;return Object(b.jsxs)("div",{children:[' "',n,'" not found']})};var aa=function(){var e,n,t,i,r,o,c,s,d,u,v,j,h,p=Object(A.h)().analysis_id,m=Object(A.f)().state,O=Object(A.g)(),x=function(e,n){return Object(l.useQuery)(Object(F.a)(Object(F.a)({},n),{},{enabled:!!e,queryKey:["ImageDocument",e],queryFn:function(){return $t(e)}}))}(p,{useErrorBoundary:!1,refetchInterval:function(e){var n;return!(null===e||void 0===e||null===(n=e.data)||void 0===n||!n.status)&&1e4}}),f=(j=null!==(e=null===m||void 0===m?void 0:m.image_name)&&void 0!==e?e:null===(n=x.data)||void 0===n||null===(t=n.data)||void 0===t||null===(i=t.metadata)||void 0===i||null===(r=i.arguments)||void 0===r||null===(o=r["extract-image"])||void 0===o?void 0:o.image,Object(l.useQuery)(Object(F.a)(Object(F.a)({},h),{},{enabled:!!j,queryKey:["ImageMetadata",j],queryFn:function(){return na(j)}}))),g=function(e,n){return Object(l.useQuery)(Object(F.a)(Object(F.a)({},n),{},{enabled:!!e,queryKey:["ImageLogs",e],queryFn:function(){return ea(e)}}))}(p,{useErrorBoundary:!1,refetchInterval:function(){var e,n;return!(null===(e=x.data)||void 0===e||null===(n=e.data)||void 0===n||!n.status)&&1e4}}),y=function(e){var n=vt(e),t=jt(e);return Object(a.useMemo)((function(){var e={dependencies:null,licenses:null};return n&&(e.dependencies=n),t&&(e.licenses=t),e}),[n,t])}(Ot(Object(a.useMemo)((function(){var e,n;if(null!==(e=x.data)&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.metadata){var t,a,i,r,o,c,l,s={name:null!==(t=null===(a=x.data.data.result)||void 0===a||null===(i=a["operating-system"])||void 0===i?void 0:i.id)&&void 0!==t?t:"rhel",version:null!==(r=null===(o=x.data.data.result)||void 0===o||null===(c=o["operating-system"])||void 0===c||null===(l=c.version_id)||void 0===l?void 0:l.split(".")[0])&&void 0!==r?r:"8",python_version:x.data.data.metadata.python.major+"."+x.data.data.metadata.python.minor};return function(e,n){return e.map((function(e){return{name:e.package_name,version:e.package_version,index:"https://pypi.org/simple",os_name:n.name,os_version:n.version,python_version:n.python_version}}))}(x.data.data.result["python-packages"],s)}}),[x.data])));if(null!==x&&void 0!==x&&x.isLoading)return Object(b.jsx)("div",{className:"w-full h-48 flex justify-center items-center",children:Object(b.jsx)(Ie.a,{})});if(null===x||void 0===x||!x.data){var k=null===m||void 0===m?void 0:m.image_name;return k?(ce(k).then((function(e){O("/image/"+e.data.analysis_id,{state:{image_name:k}})})),Object(b.jsx)("div",{className:"w-full h-48 flex justify-center items-center",children:Object(b.jsx)(Ie.a,{})})):Object(b.jsx)("div",{"data-testid":"image-not-loaded",children:Object(b.jsx)(ft,{children:Object(b.jsx)(ta,{analysis_id:p})})})}return Object(b.jsx)("div",{"data-testid":"image-loaded",children:Object(b.jsxs)(ft,{goHome:!0,children:[Object(b.jsx)(Ht,{imageDocument:null===(c=x.data)||void 0===c?void 0:c.data,logs:null===(s=g.data)||void 0===s||null===(d=s.data)||void 0===d?void 0:d.log}),Object(b.jsx)(Xt,{imageMetadata:null===(u=f.data)||void 0===u?void 0:u.data,metrics:y,imageDocument:null===(v=x.data)||void 0===v?void 0:v.data})]})})},ia=function(){return Object(b.jsx)(P.a,{basename:"/search-stage",children:Object(b.jsxs)(A.d,{children:[Object(b.jsx)(A.b,{path:"/",element:Object(b.jsx)(We,{})}),Object(b.jsx)(A.b,{path:"advise/:analysis_id/*",element:Object(b.jsx)(gt,{})}),Object(b.jsx)(A.b,{path:"package/:package_name/*",element:Object(b.jsx)(Wt,{})}),Object(b.jsx)(A.b,{path:"image/:analysis_id/*",element:Object(b.jsx)(aa,{})}),Object(b.jsx)(A.b,{path:"*",element:Object(b.jsx)(Ne,{})})]})})};var ra=function(){return Object(b.jsx)(I,{children:Object(b.jsx)(ia,{})})};o.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(ra,{})}),document.getElementById("root"))}},[[286,1,2]]]);
//# sourceMappingURL=main.da1a4447.chunk.js.map